
[[cls_9]]
== Examples

=== Illustrations of aspects of this Supplement

[[scls_9-1-1]]
==== {blank}

The examples given illustrate various aspects of this Supplement. They show the application of the GUM uncertainty framework with and without contributions derived from higher-order terms in the Taylor series approxi-mation of the model function. They also show the corresponding results provided by

. MCM using pre-assigned numbers stem:[ii(M)] of Monte Carlo trials,
. [[item_9-1-1b]]the adaptive Monte Carlo procedure (see <<scls_7-9-4>>) in which stem:[ii(M)] is determined automatically, or
. both.


==== {blank}

Some of the examples further show whether the MCM results provided in <<item_9-1-1b>> in <<scls_9-1-1>> validate those provided by the GUM uncertainty framework. A numerical tolerance stem:[delta] (see <<scls_7-9-2>>) associated with stem:[u(y)], with stem:[delta] chosen appropriately, is used in comparing MCM and the GUM uncertainty framework. The Monte Carlo results provided in <<item_9-1-1b>> were obtained using a numerical tolerance of stem:[delta//5] (see <<scls_8-2>>). In some instances, solutions are obtained analytically for further comparison.


[[scls_9-1-3]]
==== {blank}

Results are generally reported in the manner described in <<scls_5-5>>. However, more than the recommended one or two significant decimal digits are often given to facilitate comparison of the results obtained from the various approaches.


==== {blank}

The Mersenne Twister generator <<Matsumoto1998>> was used to generate pseudo-random numbers from a rectangular distri-bution (see <<scls_C-3>>). It passes a comprehensive test for pseudo-random numbers drawn from a rectangular distribution <<Ecuyerm>> (see <<scls_C-3-2>>) and is available within MATLAB <<Moler2004>>, the programming environment used to produce the results given here.


==== {blank}

The first example (see <<scls_9-2>>) constitutes an additive model. It demonstrates that the results from MCM agree with those from the application of the GUM uncertainty framework when the conditions hold for the latter (as in <<scls_5-7>>). The same model, but with different PDFs assigned to the input quantities, is also considered to demonstrate some departures when not all the conditions hold.


==== {blank}

The second example (see <<scls_9-3>>) is a calibration problem from mass metrology. It demonstrates that the GUM uncertainty framework is valid in this instance only if the contributions derived from higher-order terms in the Taylor series approximation of the model function are included.


==== {blank}

The third example (see <<scls_9-4>>) is concerned with electrical measurement. It shows that the PDF for the output quantity can be markedly asymmetric, and thus the GUM uncertainty framework can yield invalid results, even if all higher-order terms are taken into account. Instances where the input quantities are independent and not independent are treated.


==== {blank}

The fourth example (see <<scls_9-5>>) is that in the GUM concerned with gauge block calibration <<JCGM-100,clause=H.1>>. The information given there concerning the model input quantities is interpreted, PDFs accordingly assigned to these quantities, and results from the GUM uncertainty framework and MCM obtained and compared. Moreover, this treatment is applied both to the original model and the approximation made to it in the GUM.


[[scls_9-2]]
=== Additive model

==== Formulation

This example considers the additive model

[[eq21]]
[stem]
++++
Y = X_1 + X_2 + X_3 + X_4,
++++

a special case of the generic linear model considered in the GUM, for three different sets of PDFs stem:[g_{X_i} (xi_i)] assigned to the input quantities stem:[ii(X)_i], regarded as independent. The stem:[ii(X)_i] and hence the output quantity stem:[ii(Y)] have dimension 1. For the first set, each stem:[g_{X_i} (xi_i)] is a standard Gaussian PDF (with stem:[ii(X)_i] having expectation zero and standard deviation unity). For the second set, each stem:[g_{X_i} (xi_i)] is a rectangular PDF, also with stem:[ii(X)_i] having expectation zero and standard deviation unity. The third set is identical to the second except that the PDF for stem:[g_{X_4} (xi_4)] has a standard deviation of ten.

NOTE: Further information concerning additive models, such as the model <<eq21,(21)>>, where the PDFs are Gaussian or rectangular or a combination of both, is available <<Dietrich1991>>.


==== Normally distributed input quantities

[[scls_9-2-2-1]]
===== {blank}

Assign a standard Gaussian PDF to each stem:[ii(X)_i]. The best estimates of the stem:[ii(X)_i] are stem:[x_i = 0, i = 1, 2, 3, 4], with associated standard uncertainties stem:[u(x_i) = 1].


[[scls_9-2-2-2]]
===== {blank}

The results obtained are summarized in the first five columns of <<table2>>, with the results reported to three significant figures in order to facilitate their comparison (see <<scls_9-1-3>>).

NOTE: The probabilistically symmetric 95 % coverage interval is determined, because the PDF for stem:[ii(Y)] is known to be symmetric in this case, as it is for the other cases considered in this example.

[[scls_9-2-2-3]]
===== {blank}

The law of propagation of uncertainty <<JCGM-100,clause=5.1.2>> gives the estimate stem:[y = 0.0] of stem:[ii(Y)] and associated standard uncertainty stem:[u(y) = 2.0], using a numerical tolerance of two significant decimal digits for stem:[u(y) (delta = 0.05)] (see <<scls_5-5>>). A probabilistically symmetric 95 % coverage interval for stem:[ii(Y)], based on a coverage factor of 1.96, is [-3.9, 3.9].


===== {blank}

The application of MCM (<<cls_7>>) with stem:[M = 10^5] trials gives stem:[y = 0.0], stem:[u(y) = 2.0] and the probabilistically symmetric 95 % coverage interval [-3.9, 3.9]. Two further applications of the method, with stem:[M = 10^6] trials, agree with these results to within the numerical tolerance used. These two further applications (different random samplings being made from the PDFs) were made to demonstrate the variation in the results obtained. The fourth and fifth numerical values of stem:[ii(M)] (stem:[1.23 xx 10^6] and stem:[1.02 xx 10^6]) are the numbers of trials for two applications of the adaptive Monte Carlo procedure (see <<scls_7-9>>) with the use of a numerical tolerance of stem:[delta//5] (see <<scls_8-2>>).


[[scls_9-2-2-5]]
===== {blank}

The PDF for stem:[ii(Y)] obtained analytically is the Gaussian PDF with expectation zero and standard deviation two.


[[scls_9-2-2-6]]
===== {blank}

<<fig6>> shows the (Gaussian) PDF for stem:[ii(Y)] resulting from the GUM uncertainty framework. It also shows one of the approximations (scaled frequency distribution (histogram) of stem:[M = 10^6] model values of stem:[ii(Y)]) constituting the discrete representation G (see <<scls_7-5>>) to this PDF provided by MCM. The endpoints of the probabilistically symmetric 95 % coverage interval provided by both methods are shown as vertical lines. The PDF and the approximation are visually indistinguishable, as are the respective coverage intervals. For this example, such agreement would be ex-pected (for a sufficiently large value of stem:[M]), because all the conditions hold for the application of the GUM uncertainty framework (see <<scls_5-7>>).


[[table2]]
.The application to the model <<eq21,(21)>>, with each stem:[ii(X)_i] assigned a standard Gaussian PDF, of (a) the GUM uncertainty framework (GUF), (b) MCM, and \(c) an analytical approach (<<scls_9-2-2-2>>, <<scls_9-2-2-7>>, <<scls_9-2-3-4>>)
[cols="8*",options="header"]
|===
| Method | stem:[ii(M)] | stem:[y] | stem:[u(y)] | Probabilistically symmetric 95 % coverage interval | stem:[d_{"low"}] | stem:[d_{"high"}] | GUF validated (stem:[delta = 0.05])?

| GUF | | 0.00 | 2.00 | [–3.92, 3.92] | | | 
| MCM | stem:[10^5] | 0.00 | 2.00 | [–3.94, 3.92] | | |
| MCM | stem:[10^6] | 0.00 | 2.00 | [–3.92, 3.92] | | |
| MCM | stem:[10^6] | 0.00 | 2.00 | [–3.92, 3.92] | | |
| Adaptive MCM | stem:[1.23 xx 10^6] | 0.00 | 2.00 | [–3.92, 3.93] | 0.00 | 0.01 | Yes
| Adaptive MCM | stem:[1.02 xx 10^6] | 0.00 | 2.00 | [–3.92, 3.92] | 0.00 | 0.00 | Yes
| Analytical | | 0.00 | 2.00 | [–3.92, 3.92] | | |
|===


[[fig6]]
.Approximations for the model <<eq21,(21)>>, with each stem:[ii(X)_i] assigned a standard Gaussian PDF, to the PDF for stem:[ii(Y)] provided by (a) the GUM uncertainty framework and (b) MCM (<<scls_9-2-2-6>>, <<scls_9-2-3-3>>). "Unit" denotes any unit
image::figure6.png[]


[[scls_9-2-2-7]]
===== {blank}

Columns 6 to 8 of <<table2>> also shows the results of applying the validation procedures of <<scls_8-1>> and <<scls_8-2>>. Using the terminology of <<scls_7-9-2>>, stem:[n_{"dig"} = 2], since two significant decimal digits in stem:[u(y)] are sought. Hence, stem:[u(y) = 2.0 = 20 xx 10^{-1}], and so stem:[c = 20] and stem:[cc(l) = -1]. Thus, according to <<scls_7-9-2>>, the numerical tolerance is

[stem%unnumbered]
++++
delta = 1/2 xx 10^{-1} = 0.05.
++++

The magnitudes stem:[d_{"low"}] and stem:[d_{"high"}] of the endpoint differences (<<eq19>> and <<eq20>>) are shown in <<table2>> for the two applications of the adaptive Monte Carlo procedure. Also shown is whether the GUM uncertainty framework has been validated for stem:[delta = 0.05].


[[scls_9-2-2-8]]
===== {blank}

<<fig7>> shows the length stem:[y_{"high"} - y_{"low"}] of the 95 % coverage interval for stem:[ii(Y)] (see <<scls_7-7>>), as a function of the probability at its left-hand endpoint, determined from stem:[bb(G)]. As expected for a symmetric PDF, the interval takes its shortest length when symmetrically located with respect to the expectation.


[[fig7]]
.The length of the 95 % coverage interval, as a function of the probability at its left-hand endpoint, for the discrete representation G of the distribution function obtained by applying MCM to the model <<eq21,(21)>> (<<scls_9-2-2-8>>, <<scls_9-4-2-2-11>>)
image::figure7.png[]


===== {blank}

Subclause <<scls_9-4>> provides an example of an asymmetric PDF for which the shortest coverage interval differs appreciably from the probabilistically symmetric coverage interval.


[[scls_9-2-3]]
==== Rectangularly distributed input quantities with the same width

===== {blank}

Assign a rectangular PDF to each stem:[ii(X)_i], so that stem:[ii(X)_i] has an expectation of zero and a standard deviation of unity (in contrast to <<scls_9-2-2-1>> where a Gaussian PDF is assigned). Again, the best estimates of the stem:[ii(X)_i] are stem:[x_i = 0, i = 1, 2, 3, 4], with associ= ated standard uncertainties stem:[u(x_i) = 1].


[[scls_9-2-3-2]]
===== {blank}

By following the analogous steps of <<scls_9-2-2-3>> to <<scls_9-2-2-5>>, the results in <<table3>> were obtained. The analytic solution for the endpoints of the probabilistically symmetric 95 % coverage interval, viz. stem:[+-2 sqrt(3)[2 - (3//5)^{1//4}\] ~~ +-3.88], was obtained as described in <<annexE>>.


[[table3]]
.As <<table2>>, but for rectangular PDFs, with the stem:[ii(X)_i] having the same expectations and standard deviations (<<scls_9-2-3-2>>, <<scls_9-2-3-3>>, <<scls_9-2-3-4>>)
[cols="8*",options="header"]
|===
| Method | stem:[M] | stem:[y] | stem:[u(y)] | Probabilistically symmetric 95 % coverage interval | stem:[d_{"low"}] | stem:[d_{"high"}] | GUF validated (stem:[delta = 0.05])?

| GUF | | 0.00 | 2.00 | [–3.92, 3.92] | | |
| MCM | stem:[10^5] | 0.00 | 2.01 | [–3.90, 3.89] | | |
| MCM | stem:[10^6] | 0.00 | 2.00 | [–3.89, 3.88] | | |
| MCM | stem:[10^6] | 0.00 | 2.00 | [–3.88, 3.88] | | |
| Adaptive MCM | stem:[1.02 xx 10^6] | 0.00 | 2.00 | [–3.88, 3.89] | 0.04 | 0.03 | Yes
| Adaptive MCM | stem:[0.86 xx 10^6] | 0.00 | 2.00 | [–3.87, 3.87] | 0.05 | 0.05 | No
| Analytical | | 0.00 | 2.00 | [–3.88, 3.88] | | |
|===


[[scls_9-2-3-3]]
===== {blank}

<<fig8>> shows the counterpart of <<fig6>> in this case. By comparison with <<fig6>>, some modest differences between the approximations to the PDFs can be seen. The GUM uncertainty framework provides exactly the same PDF for stem:[ii(Y)] when the PDFs for the stem:[ii(X)_i] are Gaussian or rectangular, because the expectations of these quantities are identical, as are the standard deviations, in the two cases. The PDF provided by MCM takes smaller values than those provided by the GUM uncertainty framework in the neighbourhood of the expectation and to a smaller extent towards the tails. It takes slightly greater values in the flanks. The endpoints of the coverage intervals provided are again almost visually indistinguishable, but <<table3>> shows small differences.


[[scls_9-2-3-4]]
===== {blank}

The probabilistically symmetric 95 % coverage interval determined on the basis of the GUM un-certainty framework is in this case slightly more conservative than that obtained analytically. As for nor-mally distributed quantities, the validation procedure was applied (columns 6 to 8 of <<table3>>). As before, stem:[n_{"dig"} = 2], stem:[u(y) = 20 xx 10^{-1}], stem:[c = 20], stem:[cc(l) = -1] and stem:[delta = 0.05]. The endpoint differences stem:[d_{"low"}] and stem:[d_{"high"}] are larger than for the case of normally distributed quantities (<<table2>>). For the first of the two applications of the adaptive Monte Carlo procedure, the GUM uncertainty framework is validated. For the second application, it is not validated, although stem:[d_{"low"}] and stem:[d_{"high"}] for this application are close to the numerical tolerance stem:[delta = 0.05] (seen if more decimal digits than in <<table3>> are considered). Different validation results such as these are an occasional consequence of the stochastic nature of the Monte Carlo method, especially in a case such as that here.

[[fig8]]
.The counterpart of <<fig6>> for quantities having the same expectations and standard deviations, but rectangular PDFs (<<scls_9-2-3-3>>)
image::figure8.png[]


==== Rectangularly distributed input quantities with different widths

[[scls_9-2-4-1]]
===== {blank}

Consider the example of <<scls_9-2-3>>, except that stem:[ii(X)_4] has a standard deviation of ten rather than unity. <<table4>> contains the results obtained.

===== {blank}

The numbers stem:[ii(M)] of Monte Carlo trials taken by the adaptive procedure (stem:[0.03 xx 10^6] and stem:[0.08 xx 10^6]) are much smaller than they were for the two previous cases in this example. The main reason is that, in this case, stem:[delta = 0.5], the numerical tolerance resulting from requesting, as before, two significant decimal digits in stem:[u(y)], is ten times the previous value. Were the previous value to be used, stem:[ii(M)] would be of the order of 100 times greater.


[[table4]]
.As <<table3>>, except that the fourth input quantity has a standard deviation of ten rather than unity, and no analytic solution is provided (<<scls_9-2-4-1>>, <<scls_9-2-4-5>>)
[cols="8*",options="header"]
|===
| Method | stem:[ii(M)] | stem:[y] | stem:[u(y)] | Probabilistically symmetric 95 % coverage interval | stem:[d_{"low"}] | stem:[d_{"high"}] | GUF validated (stem:[delta = 0.5])?

| GUF | | 0.0 | 10.1 | [–19.9, 19.9] | | |
| MCM | stem:[10^5] | 0.0 | 10.2 | [–17.0, 17.0] | | |
| MCM | stem:[10^6] | 0.0 | 10.2 | [–17.0, 17.0] | | |
| MCM | stem:[10^6] | 0.0 | 10.1 | [–17.0, 17.0] | | |
| Adaptive MCM | stem:[0.03 xx 10^6] | 0.1 | 10.2 | [–17.1, 17.1] | 2.8 | 2.8 | No
| Adaptive MCM | stem:[0.08 xx 10^6] | 0.0 | 10.1 | [–17.0, 17.0] | 2.9 | 2.9 | No
|===


[[scls_9-2-4-3]]
===== {blank}

<<fig9>> shows the two approximations obtained to the PDF for stem:[ii(Y)]. They differ appreciably. The dominance of the PDF for stem:[ii(X)_4] is evident. The PDF for stem:[ii(Y)] resembles that for stem:[ii(X)_4], but there is an effect in the flanks resulting from the PDFs for the other stem:[ii(X)_i].


[[scls_9-2-4-4]]
===== {blank}

<<fig9>> also shows the endpoints of the probabilistically symmetric 95 % coverage interval for stem:[ii(Y)] obtained from these approximations. The inner pair of vertical lines indicates the endpoints of the probabilistically symmet-ric 95 % coverage interval determined by MCM. The outer pair results from the GUM uncertainty framework, with a coverage factor of k = 1.96.


[[fig9]]
.As <<fig8>>, except that the fourth input quantity has a standard deviation of ten rather than unity (<<scls_9-2-4-3>>, <<scls_9-2-4-4>>)
image::figure9.png[]


[[scls_9-2-4-5]]
===== {blank}

The probabilistically symmetric 95 % coverage interval determined on the basis of the GUM uncertainty framework in this case is more conservative than that obtained using MCM. Again, the validation procedure was applied (columns 6 to 8 of <<table4>>). Now, stem:[n_{"dig"} = 2], stem:[u(y) = 1.0 xx 10^1 = 10 xx 10^0], stem:[c = 10], stem:[cc(l) = 0] and stem:[delta = 1//2 xx 10^0 = 0.5]. For the two applications of the adaptive Monte Carlo procedure, the GUM uncertainty framework is not validated. For a numerical tolerance of one significant decimal digit in stem:[u(y)], i.e. stem:[n_{"dig"} = 1], for which stem:[delta = 5], the validation status would be positive in both cases, the 95 % coverage intervals all being stem:[[-2 xx 10^1, 2 xx 10^1\]]. See <<scls_4-13>>.

NOTE: The conditions for the central limit theorem to apply are not well met in this circumstance <<JCGM-100,clause=G.6.5>>, because of the dominating effect of the rectangular PDF for stem:[ii(X)_4] (see <<scls_5-7-2>>). However, because these conditions are often in practice assumed to hold, especially when using proprietary software for uncertainty evaluation (cf. <<scls_9-4-2-5>> <<note3_9-4-2-5>>), the characterization of stem:[ii(Y)] by a Gaussian PDF on the assumption of the applicability of this theorem is made in this subclause for comparison purposes.


[[scls_9-3]]
=== Mass calibration

==== Formulation

===== {blank}

Consider the calibration of a weight stem:[W] of mass density stem:[rho_W] against a reference weight stem:[R] of mass density stem:[rho_R] having nominally the same mass, using a balance operating in air of mass density stem:[rho_a] <<OIML2004>>. Since stem:[rho_W] and stem:[rho_R] are generally different, it is necessary to account for buoyancy effects. Applying Archimedes' principle, the model takes the form

[[eq22]]
[stem]
++++
m_W (1 - rho_a//rho_W) = (m_R + delta_{m_R})(1 - rho_a//rho_R)
++++

where stem:[delta m_R] is the mass of a small weight of density stem:[rho_R] added to stem:[R] to balance it with stem:[W].


===== {blank}

It is usual to work in terms of conventional masses. The conventional mass stem:[m_{W,c}] of stem:[W] is the mass of a (hypothetical) weight of density stem:[rho_0 = 8000 " "rm(kg/m)^3] that balances W in air at density stem:[rho_{a_0} = 1.2 " "rm(kg/m)^3]. Thus,

[stem%unnumbered]
++++
m_W(1 - rho_{a_0}//rho_W) = m_{W,c}(1 - rho_{a_0}//rho_0).
++++


===== {blank}

In terms of conventional masses stem:[m_{W,c}], stem:[m_{R,c}] and stem:[delta m_{R,c}], the model <<eq22,(22)>> becomes

[[eq23]]
[stem]
++++
m_{W,c} (1 - rho_a//rho_W)(1 - rho_{a_0}//rho_W)^{-1} = (m_{R,c} + delta m_{R,c})(1 - rho_a//rho_R)(1 - rho_{a_0}//rho_R)^{-1},
++++

from which, to an approximation adequate for most practical purposes,

[stem%unnumbered]
++++
m_{W,c} = (m_{R,c} + delta m_{R,c}) [1 + (rho_a - rho_{a_0}) (1/rho_W - 1/rho_R)].
++++

Let

[stem%unnumbered]
++++
delta m = m_{W,c} - m_{"nom"} 
++++

be the deviation of stem:[m_{W,c}] from the nominal mass 

[stem%unnumbered]
++++
m_{"nom"} = 100 " "rm(g). 
++++

The model used in this example is given by 

[[eq24]]
[stem]
++++
delta m = (m_{R,c} + delta m_{R,c}) [1 + (rho_a - rho_{a_0}) (1/rho_W - 1/rho_R)] - m_{"nom"}.
++++

NOTE: Applying the law of propagation of uncertainty to the "exact" model <<eq23,(23)>> is made difficult by the algebraic complexity of the partial derivatives. It is easier to apply MCM, because only model values need be formed.


[[scls_9-3-1-4]]
===== {blank}

The only information available concerning stem:[m_{R,c}] and stem:[delta m_{R,c}] is a best estimate and an associated standard uncertainty for each of these quantities. Accordingly, following <<scls_6-4-7-1>>, a Gaussian distribution is assigned to each of these quantities, with these best estimates used as the expectations of the corresponding quantities and the associated standard uncertainties as the standard deviations. The only information available concerning stem:[rho_a], stem:[rho_W] and stem:[rho_R] is lower and upper limits for each of these quantities. Accordingly, following <<scls_6-4-2-1>>, a rectangular distribution is assigned to each of these quantities, with limits equal to the endpoints of the distribution. <<table5>> summarizes the input quantities and the PDFs assigned. In the table, a Gaussian distribution stem:[N(mu, sigma^2)] is described in terms of expectation stem:[mu] and standard deviation stem:[sigma], and a rectangular distribution stem:[R(a, b)] with endpoints stem:[a] and stem:[b(a < b)] in terms of expectation stem:[(a + b)//2] and semi-width stem:[(b - a)//2].


NOTE: The quantity stem:[rho_{a_0}] in the mass calibration model <<eq24,(24)>> is assigned the value stem:[1.2 " "rm(kg/m)^3] with no associated uncertainty.


[[table5]]
.The input quantities stem:[ii(X)_i] and the PDFs assigned to them for the mass calibration model <<eq24,(24)>> (<<scls_9-3-1-4>>)
[cols="6*",options="header"]
|===
^| stem:[X_i] ^| Distribution 4+^| Parameters
| | ^h| Expectation stem:[mu] ^h| Standard deviation stem:[sigma] ^h| Expectation stem:[x = (a + b)//2] ^h| Semi-width stem:[(b - a)//2]

| stem:[m_{R,c}] | stem:[N(mu,sigma^2)] | stem:[100000000 " "rm(mg)] | stem:[0.050 " "rm(mg)] | |
| stem:[delta m_{R,c}] | stem:[N(mu,sigma^2)] | 1.234 mg | 0.020 mg | |
| stem:[rho_a] | stem:[R(a,b)] | | | stem:[1.20 " "rm(kg/m)^3] | stem:[0.10 " "rm(kg/m)^2]
| stem:[rho_W] | stem:[R(a,b)] | | | stem:[8 xx 10^3 " "rm(kg/m)^3] | stem:[1 xx 10^3 " "rm(kg/m)^3]
| stem:[rho_R] | stem:[R(a,b)] | | | stem:[8.00 xx 10^3 " "rm(kg/m)^3] | stem:[0.05 xx 10^3 " "rm(kg/m)^3]
|===


==== Propagation and summarizing

[[scls_9-3-2-1]]
===== {blank}

The GUM uncertainty framework and the adaptive Monte Carlo procedure (see <<scls_7-9>>) were each used to obtain an estimate stem:[hat(delta m)] of stem:[delta m], the associated standard uncertainty stem:[u(hat(delta m))], and the shortest 95 % coverage interval for stem:[delta m]. The results obtained are shown in <<table6>>, in which GUF~1~ denotes the GUM uncertainty framework with first-order terms, MCM the adaptive Monte Carlo procedure, and GUF~2~ the GUM uncertainty framework with higher-order terms.


===== {blank}

stem:[0.72 xx 10^6] trials were taken by the adaptive Monte Carlo procedure with the use of a numerical tolerance of stem:[delta//5] (see <<scls_8-2>>) with stem:[delta] set for the case where one significant decimal digit in stem:[u(hat(delta m))] is regarded as meaningful (see <<scls_9-3-2-6>>).


[[scls_9-3-2-3]]
===== {blank}

<<fig10>> shows the approximations to the PDF for stem:[delta m] obtained from the GUM uncertainty framework with first-order terms and MCM. The continuous curve represents a Gaussian PDF with parameters given by the GUM uncertainty framework. The inner pair of (broken) vertical lines indicates the shortest 95 % coverage interval for stem:[delta m] based on this PDF. The histogram is the scaled frequency distribution obtained using MCM as an approximation to the PDF. The outer pair of (continuous) vertical lines indicates the shortest 95 % coverage interval for stem:[delta m] based on the discrete representation of the distribution function determined as in <<scls_7-5>>.


[[table6]]
.Results of the calculation stage for the mass calibration model <<eq24,(24)>> (<<scls_9-3-2-1>>, <<scls_9-3-2-6>>)
[cols="7*",options="header"]
|===
| Method | stem:[hat(delta m)//rm(mg)] | stem:[u(hat(delta m))] | Shortest 95 % coverage interval stem:[//"mg"] | stem:[d_{"low"}//"mg"] | stem:[d_{"high"}//"mg"] | GUF validated (stem:[delta = 0.005])?

| GUF~1~ | stem:[1.2340] | stem:[0.0539] | stem:[[1.1285,1.3395\]] | stem:[0.0451] | stem:[0.0430] | No
| MCM | stem:[1.2341] | stem:[0.0754] | stem:[[1.0834, 1.3825\]] | | |
| GUF~2~ | stem:[1.2340] | stem:[0.0750] | stem:[[1.0870, 1.3810\]] | stem:[0.0036] | stem:[0.0015] | Yes
|===


[[fig10]]
.Approximations to the PDF for the output quantity stem:[delta m] obtained using the GUM uncertainty framework with first-order terms and MCM (<<scls_9-3-2-3>>)
image::figure10.png[]


===== {blank}

The results show that, although the GUM uncertainty framework (first order) and MCM give estimates of stem:[delta m] in good agreement, the numerical values for the associated standard uncertainty are noticeably different. The value (0.0754 mg) of stem:[u(hat(delta m))] returned by MCM is 40 % larger than that (0.0539 mg) returned by the GUM uncertainty framework (first order). The latter is thus optimistic in this respect. There is good agreement between stem:[u(hat(delta m))] determined by MCM and that (stem:[0.0750" "rm(mg)]) provided by the GUM uncertainty framework with higher-order terms.


[[scls_9-3-2-5]]
===== {blank}

<<table7>> contains the partial derivatives of first order for the model <<eq24,(24)>> with respect to the input quantities together with the sensitivity coefficients, viz. these derivatives evaluated at the best estimates of the input quantities. These derivatives indicate that, for the purposes of the GUM uncertainty framework with first-order terms, the model for this example can be considered as being replaced by the additive model

[stem%unnumbered]
++++
delta m = m_{R,c} + delta m_{R,c} - m_{"nom"}.
++++

MCM makes no such (implied) approximation to the model.


[[table7]]
.Sensitivity coefficients for the mass calibration model <<eq24,(24)>> (<<scls_9-3-2-5>>)
[cols="^,^,^",options="header"]
|===
| stem:[X_i] | Partial derivative | Sensitivity coefficient

| stem:[m_{R,c}] | stem:[1 + (rho_a - rho_{a_0})(1//rho_W - 1//rho_R)] | 1
| stem:[delta m_{R,c}] | stem:[1 + (rho_a - rho_a_0 )(1/rho_W - 1/rho_R)] | 1
| stem:[rho_a] | stem:[(m_{R,c} + delta m_{R,c})(1//rho_W - 1//rho_R)] | 0
| stem:[rho_W] | stem:[-(m_{R,c} + delta m_{R,c})(rho_a - rho_{a_0})//rho_W^2] | 0
| stem:[rho_R] | stem:[(m_{R,c} + delta m_{R,c})(rho_a - rho_{a_0})//rho_R^2] | 0
|===


[[scls_9-3-2-6]]
===== {blank}

<<table6>> also shows in the right-most three columns the results of applying the validation procedure of <<scls_8-1>> and <<scls_8-2>> in the case where one significant decimal digit in stem:[u(hat(delta m))] is regarded as meaningful. Using the terminology of that subclause, stem:[n_{"dig"} = 1], since a numerical tolerance of one significant decimal digit in stem:[u(hat(delta m))] is required. Hence, stem:[u(hat(delta m)) = 0.08 = 8 xx 10^{-2}], and so the stem:[c] in <<scls_7-9-2>> equals 8 and stem:[cc(l) = -2]. Thus stem:[delta = 1//2 xx 10^{-2} = 0.005]. stem:[d_{"low"}] and stem:[d_{"high"}] denote the magnitudes of the endpoint differences <<eq19>> and <<eq20>>, where stem:[y] there corresponds to stem:[hat(delta m)]. Whether the results were validated to one significant decimal digit in stem:[u(hat(delta m))] is indicated in the final column of the table. If only first-order terms are accounted for, the application of the GUM uncertainty framework is not validated. If higher-order terms are accounted for <<JCGM-100,clause=5.1.2 note>>, the GUM uncertainty framework is validated. Thus, the non-linearity of the model is such that accounting for first-order terms only is inadequate.


[[scls_9-4]]
=== Comparison loss in microwave power meter calibration

==== Formulation

===== {blank}

During the calibration of a microwave power meter, the power meter and a standard power meter are connected in turn to a stable signal generator. The power absorbed by each meter will in general be different because their complex input voltage reflection coefficients are not identical. The ratio stem:[ii(Y)] of the power stem:[P_M] absorbed by the meter being calibrated and that, stem:[P_S], by the standard meter is <<Ridler2001>>

[[eq25]]
[stem]
++++
Y = P_M/P_S = {1 - |: Gamma_M :|^2}/{1 - |: Gamma_S :|^2} times {|: 1 - Gamma_S Gamma_G :|^2}/{|: 1 - Gamma_M Gamma_G :|^2},
++++

where stem:[Gamma_{"G"}] is the voltage reflection coefficient of the signal generator, stem:[Gamma_{"M"}] that of the meter being calibrated and stem:[Gamma_{"S"}] that of the standard meter. This power ratio is an instance of "comparison loss" <<Beatty1964>>, <<Kerns1967>>.


===== {blank}

Consider the case where the standard and the signal generator are reflectionless, i.e. stem:[Gamma_{"S"} = Gamma_{"G"} = 0], and measured values are obtained of the real and imaginary parts stem:[X_1] and stem:[X_2] of stem:[Gamma_M = X_1 + j X_2], where stem:[j^2 = -1]. Since stem:[|Gamma_M|^2 = X_1^2 + X_2^2], formula <<eq25>> becomes

[[eq26]]
[stem]
++++
Y = 1 - X_1^2 - X_2^2.
++++


===== {blank}

Given respectively are best estimates stem:[x_1] and stem:[x_2] of the quantities stem:[ii(X)_1] and stem:[ii(X)_2] from measurement and the associated standard uncertainties stem:[u(x_1)] and stem:[u(x_2)]. stem:[ii(X)_1] and stem:[ii(X)_2] are often not independent. Denote by stem:[u(x_1, x_2)] the covariance associated with stem:[x_1] and stem:[x_2]. Equivalently <<JCGM-100,clause=5.2.2>>, stem:[u(x_1, x_2) = r(x_1, x_2)u(x_1)u(x_2)], where stem:[r = r(x_1, x_2)] denotes the associated correlation coefficient <<JCGM-100,clause=5.2.2>>.

NOTE: In practice the electrical engineer may sometimes have difficulty in quantifying the covariance. In such cases, the uncertainty evaluation can be repeated with different trial numerical values for the correlation coefficient in order to study its effect. This example carries out calculations using a correlation coefficient of zero and of 0.9 (cf. <<scls_9-4-1-7>>).


===== {blank}

On the basis of <<scls_6-4-8-1>>, stem:[bb(X) = (X_1, X_2)^{sf(T)}] is assigned a bivariate Gaussian PDF in stem:[ii(X)_1] and stem:[ii(X)_2], with expectation and covariance matrix

[[eq27]]
[stem]
++++
[(x_1),(x_2)], " " [(u^2(x_1),ru(x_1)u(x_2)),(ru(x_1)u(x_2),u^2(x_2))].
++++


===== {blank}

Because the magnitudes of stem:[ii(X)_1] and stem:[ii(X)_2] in expression <<eq26>> are in practice small compared with unity, the resulting stem:[ii(Y)] is close to unity. Results are accordingly expressed in terms of the quantity

[[eq28]]
[stem]
++++
delta Y = 1 - Y = X_1^2 + X_2^2,
++++

taken as the model of measurement. For physical reasons, stem:[0 <= Y <= 1], and hence stem:[0 <= delta Y <= 1].


===== {blank}

The determination of an estimate stem:[delta y] of stem:[delta ii(Y)], the associated standard uncertainty stem:[u(delta y)], and a coverage interval for stem:[delta ii(Y)] will be considered for choices of stem:[x_1], stem:[x_2], stem:[u(x_1)], stem:[u(x_2)] and stem:[r(x_1, x_2)]. All quantities have dimension 1.


[[scls_9-4-1-7]]
===== {blank}

Six cases are considered, in all of which stem:[x_2] is taken as zero and stem:[u(x_1) = u(x_2) = 0.005]. The first three of these cases correspond to taking stem:[x_1 = 0], stem:[0.010], and stem:[0.050], each with stem:[r(x_1, x_2) = 0]. The other three cases correspond to taking the same stem:[x_1], but with stem:[r(x_1, x_2) = 0.9]. The various numerical values of stem:[x_1] (comparable to those occurring in practice) are used to investigate the extent to which the results obtained using the considered approaches differ.


===== {blank}

For the cases in which stem:[r = r(x_1, x_2) = 0], the covariance matrix given in formulae <<eq27>> reduces to stem:["diag"(u^2(x_1), u^2(x_2))] and the corresponding joint distribution for stem:[ii(X)_1] and stem:[ii(X)_2] to the product of two univariate Gaussian distributions for stem:[ii(X)_i], for stem:[i = 1, 2], with expectation stem:[x_i] and standard deviation stem:[u(x_i)].


[[scls_9-4-2]]
==== Propagation and summarizing: zero covariance

===== General

====== {blank}

The evaluation of uncertainty is treated by applying the propagation of distributions

. analytically (for purposes of comparison),
. using the GUM uncertainty framework, and
. using MCM.


NOTE: These approaches do not constrain the PDF for stem:[delta ii(Y)] to be no greater than unity. However, for sufficiently small uncertainties stem:[u(x_1)] and stem:[u(x_2)], as here, the PDF for stem:[delta ii(Y)] may adequately be approximated by a simpler PDF defined over all non-negative values of stem:[delta ii(Y)]. A rigorous treatment, using Bayesian inference <<Weise1992>>, which applies regardless of the magnitudes of stem:[u(x_1)] and stem:[u(x_2)], is possible, but beyond the scope of this Supplement. Also see <<cls_1>> <<note2_1>>.


[[scls_9-4-2-1-2]]
====== {blank}

stem:[delta y] and stem:[u(delta y)] can generally be formed analytically as the expectation and standard deviation of stem:[delta ii(Y)], as characterized by the PDF for stem:[delta ii(Y)]. See <<scls_F-1>>. The PDF for stem:[delta ii(Y)] can be formed analytically when stem:[x_1 = 0] and, in particular, used to determine the endpoints of the shortest 95 % coverage interval in that case. See <<scls_F-2>>.


[[scls_9-4-2-1-3]]
====== {blank}

The GUM uncertainty framework with first-order terms and with higher-order terms is applied for each of the three estimates stem:[x_1] in the uncorrelated case. See <<scls_F-3>>. An estimate stem:[delta y] of stem:[delta ii(Y)] is formed in each case <<JCGM-100,clause=4.1.4>> from

[stem%unnumbered]
++++
delta y = x_1^2 + x_2^2.
++++


====== {blank}

MCM is applied in each case with stem:[ii(M) = 10^6] trials.


===== Input estimate stem:[x_1 = 0]

[[scls_9-4-2-2-1]]
====== {blank}

For the input estimate stem:[x_1 = 0], higher-order terms must be used when applying the law of propagation of uncertainty, because the partial derivatives of stem:[delta ii(Y)] with respect to stem:[ii(X)_1] and stem:[ii(X)_2], evaluated at stem:[X_1 = x_1 and X_2 = x_2], are identically zero when stem:[x_1 = x_2 = 0]. Thus, if the law of propagation of uncertainty with first-order terms only were applied, the resulting standard uncertainty would incorrectly be computed as zero.

NOTE: A similar difficulty would arise for stem:[x_1] close to zero.


[[scls_9-4-2-2-2]]
====== {blank}

<<fig11>> shows the PDFs for stem:[delta ii(Y)] determined by applying the propagation of distributions

. analytically (the exponentially decreasing curve for stem:[delta ii(Y) >= 0] and zero elsewhere),
. using the GUM uncertainty framework with higher-order terms in order to characterize the output quantity by a Gaussian PDF (bell-shaped curve), and
. using MCM (scaled frequency distribution).

[[fig11]]
.Results for the model of comparison loss in power meter calibration in the case stem:[x_1 = x_2 = 0], with stem:[u(x_1) = u(x_2) = 0.005] and stem:[r(x_1, x_2) = 0] (<<scls_9-4-2-2-2>>, <<scls_9-4-2-2-6>>, <<scls_9-4-2-2-9>> and <<scls_9-4-2-2-11>>)
image::figure11.png[]


====== {blank}

It is seen in the figure that the use of the GUM uncertainty framework with higher-order terms in order to characterize the output quantity by a Gaussian distribution yields a PDF that is very different from the analytic solution. The latter takes the form of a particular chi-squared distribution—the sum of squares of two standard Gaussian variables (see <<scls_F-2>>).


====== {blank}

Since the partial derivatives of the model function <<eq28>> of order higher than two are all identically zero, the solution obtained essentially corresponds to taking all Taylor-series terms, i.e. the full non-linearity of the problem, into account. Thus, the particular Gaussian distribution so determined is the best that is possible using the GUM uncertainty framework to characterize the output quantity by such a distribution.


====== {blank}

It can therefore be concluded that the reason for the departure from the analytic solution of the results from the approach based on the GUM uncertainty framework is that the output quantity is characterized by a Gaussian PDF. No Gaussian PDF, however it is obtained, could adequately represent the analytic solution in this case.


[[scls_9-4-2-2-6]]
====== {blank}

It is also seen in <<fig11>> that the PDF provided by MCM is consistent with the analytic solution.


[[scls_9-4-2-2-7]]
====== {blank}

The estimates stem:[delta y] determined as the expectation of stem:[delta ii(Y)] described by the PDFs obtained

. analytically,
. using the GUM uncertainty framework, and
. applying MCM

are given in columns 2 to 4 of the row corresponding to stem:[x_1 = 0.000] in <<table8>>. Columns 5 to 8 contain the correspond-ing stem:[u(delta y)], with those obtained using the GUM uncertainty framework with first-order terms (stem:[G_1]) and higher-order terms (stem:[G_2]).


[[table8]]
.Comparison loss results, for input estimates with associated zero covariance, obtained analytically (A), and using the GUM uncertainty framework with first-order terms (stem:[G_1]) and higher-order terms (stem:[G_2]) and MCM (M) (<<scls_9-4-2-2-7>>, <<scls_9-4-2-2-10>>, <<scls_9-4-2-3-4>>, <<scls_9-4-2-4-2>>)
[cols="12*",options="header"]
|===
| stem:[x_1] 3+| Estimate stem:[delta y//10^{-6}] 4+| Standard uncertainty stem:[u(delta y)//10^{-6}] 4+| Shortest 95 % coverage interval for stem:[delta ii(Y) //10^{-6}]
| h| A h| G h| M h| A h| G~1~ h| G~2~ h| M h| A h| G~1~ h| G~2~ h| M

| stem:[0.000] | 50 | 0 | 50 | 50 | 0 | 50 | 50 | [0, 150] | [0, 0] | [–98, 98] | [0, 150]
| stem:[0.010] | 150 | 100 | 150 | 112 | 100 | 112 | 112 | -- | [–96, 296] | [–119, 319] | [0, 367]
| stem:[0.050] | stem:[2550] | stem:[2500] | stem:[2551] | 502 | 500 | 502 | 502 | -- | stem:[[1520, 3480\]] | stem:[[1515, 3485\]] | stem:[[1590, 3543\]]
|===


====== {blank}

The estimate stem:[delta y = 0] obtained by evaluating the model at the input estimates is invalid: the correct (analytic) PDF for stem:[delta ii(Y)] is identically zero for stem:[delta ii(Y) < 0]; this estimate lies on the boundary of the non-zero part of that function. The estimate provided by MCM agrees with that obtained analytically. The law of propagation of uncertainty based on first-order terms gives the wrong, zero, value for stem:[u(delta y)] already noted. The value (stem:[50 xx 10^{-6}]) from the law of propagation of uncertainty based on higher-order terms agrees with that obtained analytically and by MCM.

NOTE: When MCM was repeated several times the results obtained were scattered about stem:[50 xx 10^{-6}]. When it was repeated a number of times with a larger numerical value of stem:[ii(M)] the results were again scattered about stem:[50 xx 10^{-6}], but with a reduced dispersion. Such dispersion effects are expected, and were observed for the other Monte Carlo calculations made. Reporting the results to greater numbers of significant decimal digits would be necessary to see the actual numerical differences.


[[scls_9-4-2-2-9]]
====== {blank}

<<fig11>> also shows the shortest 95 % coverage intervals for the corresponding approximations to the distribution function for stem:[delta ii(Y)]. The 95 % coverage interval, indicated by dotted vertical lines, as provided by the GUM uncertainty framework is infeasible: it is symmetric about stem:[delta ii(Y) = 0] and therefore erroneously implies there is a 50 % probability that stem:[delta ii(Y)] is negative. The continuous vertical lines are the endpoints of the shortest 95 % coverage interval derived from the analytic solution, as described in <<scls_F-2>>. The endpoints of the shortest 95 % coverage interval determined using MCM are indistinguishable to graphical accuracy from those for the analytic solution.


[[scls_9-4-2-2-10]]
====== {blank}

The endpoints of the shortest coverage intervals relating to the standard uncertainties in columns 5 to 8 of the row corresponding to stem:[x_1 = 0.000] in <<table8>> are given in columns 9 to 12 of that table.


[[scls_9-4-2-2-11]]
====== {blank}

<<fig12>> shows the length of the 95 % coverage interval (see <<scls_7-7>>), as a function of the probability value at its left-hand endpoint, for the approximation to the PDF provided by MCM shown in <<fig11>>. The 95 % coverage interval does not take its shortest length when symmetrically located with respect to the expectation in this case. Indeed, the shortest 95 % coverage interval is as far-removed as possible from a probabilistically symmetric coverage interval, the left and right tail probabilities being 0 % and 5 %, respectively, as opposed to 2.5 % and 2.5 %. This figure can be compared with that (<<fig7>>) for the additive model of <<scls_9-2>>, for which the PDF for stem:[ii(Y)] is symmetric about its expectation.


===== Input estimate stem:[x_1 = 0.010]

[[scls_9-4-2-3-1]]
====== {blank}

For the input estimate stem:[x_1 = 0.010], with correlation coefficient stem:[r(x_1, x_2) = 0], <<fig13>> shows the PDFs obtained using the GUM uncertainty framework with first-order terms only and with higher-order terms, and us-ing MCM.


====== {blank}

The PDF provided by MCM exhibits a modest left-hand flank, although it is truncated at zero, the smallest possible numerical value of stem:[delta ii(Y)]. Further, compared with the results for stem:[x_1 = 0], it is closer in form to the Gaussian PDFs provided by the GUM uncertainty framework. These Gaussian PDFs are in turn reasonably close to each other, stem:[delta ii(Y)] having expectation stem:[1.0 xx 10^{-4}] and standard deviations stem:[1.0 xx 10^{-4}] and stem:[1.1 xx 10^{-4}], respectively.


[[scls_9-4-2-3-3]]
====== {blank}

<<fig13>> also shows the endpoints of the shortest 95 % coverage intervals obtained by the three approaches. The continuous vertical lines denote the endpoints of the interval provided by MCM, the broken vertical lines those resulting from the GUM uncertainty framework with first-order terms, and the dotted vertical lines from the GUM uncertainty framework with higher-order terms. The intervals provided by the GUM uncertainty framework are shifted to the left compared with the shortest 95 % coverage interval for MCM. As a consequence, they again


[[fig12]]
.The length of the 95 % coverage interval, as a function of the probability value at its left-hand endpoint, for the approximation to the distribution function obtained by applying MCM to the model <<eq28,(28)>> (<<scls_9-4-2-2-11>>)
image::figure12.png[]


[[fig13]]
.As <<fig11>> except that stem:[x_1 = 0.010], and the PDFs resulting from the GUM uncertainty framework with first-order (higher-peaked curve) and with higher-order terms (lower-peaked curve) (<<scls_9-4-2-3-1>>, <<scls_9-4-2-3-3>>, <<scls_9-4-2-4-1>>, <<scls_9-4-3-3>>)
image::figure13.png[]


include infeasible values of stem:[delta ii(Y)]. The shift is about 70 % of the standard uncertainty. The interval provided by MCM has its left-hand endpoint at zero, the smallest feasible value.


[[scls_9-4-2-3-4]]
====== {blank}

The corresponding results are given in the penultimate row of <<table8>>.


===== Input estimate stem:[x_1 = 0.050]

[[scls_9-4-2-4-1]]
====== {blank}

<<fig14>> is similar to <<fig13>>, but for stem:[x_1 = 0.050]. Now, the PDFs provided by both variants of the GUM uncertainty framework are virtually indistinguishable from each other. Further, they are now much closer to the approximation to the PDF provided by MCM. That PDF exhibits a slight skewness, as evidenced in the tail regions. The coverage intervals provided by the two variants of the GUM uncertainty framework are visually almost identical, but still shifted from those for MCM. The shift is now about 10 % of the standard uncertainty. The intervals provided by the GUM uncertainty framework are now feasible.

[[fig14]]
.As <<fig13>> except that stem:[x_1 = 0.050] (<<scls_9-4-2-4-1>>, <<scls_9-4-3-3>>)
image::figure14.png[]


[[scls_9-4-2-4-2]]
====== {blank}

The corresponding results are given in the final row of <<table8>>.

[[scls_9-4-2-5]]
===== Discussion

As stem:[x_1] becomes increasingly removed from zero, the results given by the GUM uncertainty framework, with first-order and with higher-order terms, and those for MCM become closer to each other.

NOTE: The numerical values stem:[x_1 = x_2 = 0] lie in the centre of the region of interest to the electrical engineer, corresponding to the so-called "matched" condition for the power meter being calibrated, and thus in no sense constitute an extreme case.

NOTE: Because of the symmetry of the model in stem:[ii(X)_1] and stem:[ii(X)_2], exactly the same effect would occur were stem:[x_2] used in place of stem:[x_1].

[[note3_9-4-2-5]]
NOTE: One reason why the GUM uncertainty framework with first-order terms (only) might be used in practice is that software for its implementation is readily available: results obtained from it might sometimes be accepted without question. For the case where stem:[x_1 = x_2 = 0] (<<fig11>>) the danger would be apparent because the standard uncertainty stem:[u(delta y)] was computed as zero, and consequently any coverage interval for stem:[delta ii(Y)] would be of zero length for any coverage probability. For stem:[x_1 != 0] (or stem:[x_2 != 0]), stem:[u(delta y)] and the length of the coverage interval for stem:[delta ii(Y)] are both non-zero, so no such warning would be available without prior knowledge of likely values for stem:[u(delta y)] and this length. Thus, a danger in implementing software based on the GUM uncertainty framework for these calculations is that checks of the software for stem:[x_1] or stem:[x_2] sufficiently far from zero would not indicate such problems, although, when used subsequently in practice for small values of stem:[x_1] or stem:[x_2], the results would be invalid, but conceivably unwittingly accepted.


==== Propagation and summarizing: non-zero covariance

===== General

[[scls_9-4-3-1-1]]
====== {blank}

The three approaches used in the cases where the stem:[ii(X)_i] are uncorrelated (see <<scls_9-4-2>>) are now applied for the three cases in which they are correlated, with stem:[r(x_1, x_2) = 0.9]. However, the GUM uncertainty framework with first-order terms only is used. Unlike the cases where the stem:[ii(X)_i] are uncorrelated, the GUM uncertainty framework with higher-order terms is not applied, no counterpart being provided in the GUM for the formula containing higher-order terms when the stem:[x_i] have associated non-zero covariances (see <<scls_5-8>>). Other aspects match those in <<scls_9-4-2>>.


====== {blank}

For the GUM uncertainty framework with first-order terms, stem:[u(delta y)] is evaluated as described in <<scls_F-3-2>>. <<eqf7>> in that subclause gives, for stem:[x_2 = 0],

[stem%unnumbered]
++++
u^2 (delta y) = 4x_1^2 u^2(x_1).
++++

Consequently, stem:[u(delta y)] does not depend on stem:[r(x_1, x_2)] and the GUM uncertainty framework with first-order terms gives identical results to those presented in <<scls_9-4-2>>. In particular, for the case stem:[x_1 = 0], stem:[u(delta y)] is (incorrectly) computed as zero, as in <<scls_9-4-2-2-1>>.


====== {blank}

MCM was implemented by sampling randomly from stem:[bb(X)] characterized by a bivariate Gaussian PDF with the given expectation and covariance matrix (<<eq27>>). The procedure in <<scls_C-5>> was used.

NOTE: Apart from the requirement to draw from a multivariate distribution, the implementation of MCM for input quantities that are correlated is no more complicated than when the input quantities are uncorrelated.


===== Input estimates stem:[x_1 = 0], stem:[0.010], and stem:[0.050]

[[scls_9-4-3-2-1]]
====== {blank}

<<table9>> contains the results obtained. Those from MCM indicate that although stem:[delta y] is unaffected by the correlation between the stem:[ii(X)_i], stem:[u(delta y)] is so influenced, more so for small stem:[x_1]. The 95 % coverage intervals are influenced accordingly.


[[table9]]
.Comparison loss results, for input estimates with associated non-zero covariance (stem:[r(x_1, x_2) = 0.9]), obtained analytically, and using the GUM uncertainty framework (GUF) and MCM (<<scls_9-4-3-2-1>>)
[cols="10*",options="header"]
|===
h| stem:[x_1] 3+h| Estimate stem:[delta y // 10^{-6}] 3+h| Standard uncertainty stem:[u(delta y)//10^{-6}] 3+h| Shortest 95 % coverage interval for stem:[delta Y//10^{-6}]

h| h| Analytical h| GUF h| MCM h| Analytical h| GUF h| MCM h| Analytical h| GUF h| MCM

| 0.000 | 50 | 0 | 50 | 67 | 0 | 67 | -- | [0, 0] | [0, 185]
| 0.010 | 150 | 100 | 150 | 121 | 100 | 121 | -- | [-96, 296] | [13, 398]
| 0.050 | stem:[2550] | stem:[2500] | stem:[2551] | 505 | 500 | 504 | -- | stem:[[1520, 3480\]] | stem:[[1628, 3555\]]
|===


[[scls_9-4-3-2-2]]
====== {blank}

<<fig15>> and <<fig16>> show the PDFs provided by the GUM uncertainty framework with first-order terms (bell-shaped curves) and MCM (scaled frequency distributions) in the cases stem:[x_1 = 0.010] and stem:[x_1 = 0.050], respectively. The endpoints of the shortest 95 % coverage interval provided by the two approaches are also shown, as broken vertical lines for the GUM uncertainty framework and continuous vertical lines for MCM.

NOTE: Strictly, the conditions under which stem:[delta ii(Y)] can be characterized by a Gaussian PDF do not hold following an application of the GUM uncertainty framework in this circumstance (see <<scls_5-8>>) <<JCGM-100,clause=G.6.6>>. However, this PDF and the endpoints of the corresponding 95 % coverage interval are shown because such a characterization is commonly used.


[[scls_9-4-3-3]]
===== Discussion

In the case stem:[x_1 = 0.010] (<<fig15>>), the effect of the correlation has been to change noticeably the results returned by MCM (compare with <<fig13>>). Not only has the shape of (the approximation to) the PDF changed, but the corresponding coverage interval no longer has its left-hand endpoint at zero. In the case stem:[x_1 = 0.050] (<<fig16>>), the differences between the results for the cases where the input quantities are uncorrelated and correlated (compare with <<fig14>>) are less obvious.


[[fig15]]
.Results for the model of comparison loss in power meter calibration in the case stem:[x_1 = 0.010], stem:[x_2 = 0], with stem:[u(x_1) = u(x_2) = 0.005] and stem:[r(x_1, x_2) = 0.9] (<<scls_9-4-3-2-2>>, <<scls_9-4-3-3>>)
image::figure15.png[]


[[fig16]]
.As <<fig15>> except that stem:[x_1 = 0.050] (<<scls_9-4-3-2-2>>, <<scls_9-4-3-3>>)
image::figure16.png[]


[[scls_9-5]]
=== Gauge block calibration

==== Formulation: model

===== {blank}

The length of a nominally 50 mm gauge block is determined by comparing it with a known reference standard of the same nominal length. The direct output of the comparison of the two gauge blocks is the difference stem:[d] in their lengths given by

[[eq29]]
[stem]
++++
d = L (1 + alpha theta) - L_s(1 + alpha_s theta_s)
++++

where L is the length at stem:[20 " °C"] of the gauge block being calibrated, stem:[L_s] is the length of the reference standard at stem:[20 " °C"] as given in its calibration certificate, stem:[alpha] and stem:[alpha_s] are the coefficients of thermal expansion, respectively, of the gauge being calibrated and the reference standard, and stem:[theta] and stem:[theta_s] are the deviations in temperature from the stem:[20 " °C"] reference temperature, respectively, of the gauge block being calibrated and the reference standard.


NOTE: The GUM refers to a gauge block as an end gauge.

NOTE: The symbol L for the length of a gauge block is used in this Supplement in place of the symbol stem:[cc(l)] used in the GUM for that quantity.


===== {blank}

From <<eq29>> the output quantity L is given by

[[eq30]]
[stem]
++++
L = {L_s (1 + alpha_ theta_s) + d} / {1 + alpha theta},
++++

from which, to an approximation adequate for most practical purposes,

[[eq31]]
[stem]
+++++
L = L_s + d + L_s(alpha_s theta_s - alpha theta).
+++++

If the difference in temperature between the gauge block being calibrated and the reference standard is written as stem:[delta theta = theta - theta_s], and the difference in their thermal expansion coefficients as stem:[delta alpha = alpha - alpha_s], models <<eq30>> and <<eq31>> become, respectively,

[[eq32]]
[stem]
++++
L = {L_s [1 + alpha_s (theta - delta theta)] + d} / {1 + (alpha_s + delta alpha)theta}
++++

and

[[eq33]]
[stem]
++++
L = L_s + d - L_s(theta delta alpha + alpha_s delta theta).
++++


===== {blank}

The difference stem:[d] in the lengths of the gauge block being calibrated and the reference standard is determined as the average of a series of five indications, obtained independently, of the difference using a calibrated comparator. stem:[d] can be expressed as

[[eq34]]
[stem]
++++
d = D + d_1 + d_2,
++++

where stem:[D] is a quantity of which the average of the five indications is a realization, and stem:[d_1] and stem:[d_2] are quantities describing, respectively, the random and systematic effects associated with using the comparator.


===== {blank}

The quantity stem:[theta], representing deviation of the temperature from stem:[20 " °C"] of the gauge block being calibrated, can be expressed as

[[eq35]]
[stem]
++++
theta = theta_0 + Delta,
++++


where stem:[theta_0] is a quantity representing the average temperature deviation of the gauge block from stem:[20 " °C"] and a quantity describing a cyclic variation of the temperature deviation from stem:[theta_0].


===== {blank}

Substituting <<eq34>> and <<eq35>> into <<eq32>> and <<eq33>>, and working with the quantity stem:[delta L] representing the deviation of L from the nominal length

[stem%unnumbered]
++++
L_{"nom"} = 50 " "rm{mm}
++++

of the gauge block, gives

[[eq36]]
[stem]
++++
delta L = {L_s [1 + alpha_s (theta_0 + Delta - delta theta)] + D + d_1 + d_2} / {1 + (alpha_s + delta alpha)(theta_0 + Delta)}
++++

and

[[eq37]]
[stem]
++++
delta L = L_s + D + d_1 + d_2 - L_s[delta alpha (theta_0 + Delta) + alpha_s delta theta] - L_{"nom"}
++++

as models for the measurement problem.


===== {blank}

The treatment here of the measurement problem is in terms of the models <<eq36,(36)>> and <<eq37,(37)>> with output quantity stem:[delta L] and input quantities stem:[L_s], stem:[D], stem:[d_1], stem:[d_2], stem:[alpha_s], stem:[theta_0], stem:[Delta], stem:[delta alpha] and stem:[delta theta]. It differs from that given in GUM example H.1 in that in the GUM the models <<eq34,(34)>> and <<eq35,(35)>> above are treated as sub-models to models <<eq32,(32)>> and <<eq33,(33)>>, i.e. the GUM uncertainty framework is applied to each model <<eq34,(34)>> and <<eq35,(35)>>, with the results obtained used to provide information about the input quantities stem:[d] and stem:[theta] in models <<eq32,(32)>> and <<eq33,(33)>>. The treatment here avoids having to use the results obtained from MCM applied to the sub-models <<eq34,(34)>> and <<eq35,(35)>> to provide information about the distributions for the input quantities stem:[d] and stem:[theta] in expressions <<eq32,(32)>> and <<eq33,(33)>>.


==== Formulation: assignment of PDFs

[[scls_9-5-2-1]]
===== General

In the following subclauses the available information about each input quantity in the models <<eq36,(36)>> and <<eq37,(37)>> is provided. This information is extracted from the description given in the GUM, and for each item of information the GUM subclause from which the item is extracted is identified. Also provided is an interpretation of the information in terms of an assignment of a distribution to the quantity. <<table10>> summarizes the assignments made.


[[table10]]
.PDFs assigned to input quantities for the gauge block models <<eq36,(36)>> and <<eq37,(37)>> on the basis of available information (<<scls_9-5-2-1>>). <<table1>> provides general information concerning these PDFs
[cols="^8*",options="header"]
|===
| Quantity | PDF 6+| Parameters

| | | stem:[mu] | stem:[sigma] | stem:[nu] | stem:[a] | stem:[b] | stem:[d]

| stem:[L_s] | stem:[t_{nu} (mu, sigma^2)] | stem:[50000623 " " rm(nm)] | 25 nm | 18 | | | 
| stem:[D] | stem:[t_{nu} (mu, sigma^2)] | 215 nm | 6 nm | 24 | | | 
| stem:[d_1] | stem:[t_{nu} (mu, sigma^2)] | 0 nm | 4 nm | 5  | | |
| stem:[d_2] | stem:[t_{nu} (mu, sigma^2)] | 0 nm | 7 nm | 8  | | |
| stem:[alpha_s] | stem:[R(a,b)] | | | | stem:[9.5 xx 10^{-6} " °C"^{-1}] | |
| stem:[theta_0] | stem:[N(mu,sigma^2)] | stem:[-0.1 " °C"] | stem:[0.2 " °C"] | | | |
| stem:[Delta] | stem:[U(a,b)] | | | | stem:[-0.5 " °C"] | stem:[0.5 " °C"] |
| stem:[delta alpha] | stem:["CTrap"(a,b,d)] | | | | stem:[-1.0 xx 10^{-6} " °C"^{-1}] | stem:[1.0 xx 10^{-6} " °C"^{-1}] | stem:[1.0 xx 10^{-6} " °C"^{-1}]
| stem:[delta theta] | stem:["CTrap"(a,b,d)] | | | | stem:[-0.050 " °C"] | stem:[0.050 " °C"] | stem:[0.025 " °C"]
|===


===== Length stem:[L_s] of the reference standard

======  Information

The calibration certificate for the reference standard gives stem:[hat(L_s) = 50.000623" " rm(mm)] as its length at stem:[20 " °C"] <<JCGM-100,clause=H.1.5>>. It gives stem:[U_p = 0.075 " "murm(m)] as the expanded uncertainty of the reference standard and states that it was obtained using a coverage factor of stem:[k_p = 3] <<JCGM-100,clause=H.1.3.1>>. The certificate states that the effective degrees of freedom associated with the combined standard uncertainty, from which the quoted expanded uncertainty was obtained, is stem:[nu_{"eff"} (u(hat(L_s))) = 18] <<JCGM-100,clause=H.1.6>>.


======  Interpretation

Assign a scaled and shifted stem:[t]-distribution stem:[t_{nu} (mu, sigma^2)] (see <<scls_6-4-9-7>>) to stem:[L_s], with

[stem%unnumbered]
++++
mu = 50000623 " mn", " " sigma = U_{"p"}/k_{"p"} = 75/3 " nm" = 25 " nm", " " nu = 18.
++++


===== Average length difference stem:[D]

======  Information

The average stem:[hat D] of the five indications of the difference in lengths between the gauge block being calibrated and the reference standard is 215 nm <<JCGM-100,clause=H.1.5>>. The pooled experimental standard deviation characterizing the comparison of stem:[L] and stem:[L_s] was determined from 25 indications, obtained independently, of the difference in lengths of two standard gauge blocks, and equalled 13 nm <<JCGM-100,clause=H.1.3.2>>.


======  Interpretation

Assign a scaled and shifted stem:[t]-distribution stem:[t_{nu}(mu, sigma^2)] (see <<scls_6-4-9-2>> and <<scls_6-4-9-6>>) to stem:[D], with

[stem%unnumbered]
++++
mu = 215 " nm", " " sigma = 13/{sqrt(5)} " nm" = 6 nm, " " nu = 24.
++++


===== Random effect stem:[d_1] of comparator

======  Information

According to the calibration certificate of the comparator used to compare stem:[L] with stem:[L_s], the associated uncertainty due to random effects is stem:[0.01" "mu rm(m)] for a coverage probability of 95 % and is obtained from six indications, obtained independently <<JCGM-100,clause=H.1.3.2>>.


======  Interpretation

Assign a scaled and shifted stem:[t]-distribution stem:[t_{nu}(mu, sigma^2)] (see <<scls_6-4-9-7>>) to stem:[d_1], with

[stem%unnumbered]
++++
mu = 0" "rm(nm), " " sigma = {U_{0.95}} / {k_{0.95}} = 10/2.57 " " rm(nm) = 4" "rm(nm)," " nu = 5.
++++

Here, stem:[k_{0.95}] is obtained from table G.2 of the GUM with stem:[nu = 5] degrees of freedom and stem:[p = 0.95].


===== Systematic effect stem:[d_2] of comparator

======  Information

The uncertainty of the comparator due to systematic effects is given in the certificate as stem:[0.02" "mu rm(m)] at the "three sigma level" <<JCGM-100,clause=H.1.3.2>>. This uncertainty may be assumed to be reliable to 25 %, and thus the degrees of freedom is stem:[nu_{"eff"}(u(hat(d_2))) = 8] <<JCGM-100,clause=H.1.6>>.


======  Interpretation

Assign a scaled and shifted stem:[t]-distribution stem:[t_{nu}(mu,sigma^2)] (see <<scls_6-4-9-7>>) to stem:[d_2], with

[stem%unnumbered]
++++
mu = 50000623 " "rm(nm), " " sigma = {U_p}/{k_p} = 75/3 " "rm(nm) = 25 " "rm(nm), " " nu = 18.
++++


===== Thermal expansion coefficient stem:[alpha_s]

====== Information 

The coefficient of thermal expansion of the reference standard is given as stem:[alpha_s = 11.5 xx 10^{-6} " °C"^{-1}] with possible values of this quantity represented by a rectangular distribution with limits stem:[+-2 xx 10^{-6} " °C"^{-1}] <<JCGM-100,clause=H.1.3.3>>.


[[scls_9-5-2-6-2]]
====== Interpretation 

Assign a rectangular distribution stem:[R(a, b)] (see <<scls_6-4-2>>) to stem:[alpha_s], with limits 

[stem%unnumbered]
++++
a = 9.5 xx 10^{-6} " °C"^{-1}," " " " b = 13.5 xx 10^{-6} " °C"^{-1}. 
++++

NOTE: There is no information about the reliability of the limits and so a rectangular distribution with exactly known limits is assigned. Such information may have been omitted from the description in the GUM because the corresponding sensitivity coefficient is zero, and so the quantity makes no contribution in an application of the GUM uncertainty framework based on first-order terms only.


===== Average temperature deviation stem:[theta_0]

======  Information

The temperature of the test bed is reported as stem:[(19.9 +- 0.5) " °C"]. The average temperature deviation stem:[hat(theta_0) = -0.1 " °C"] is reported as having an associated standard uncertainty due to the uncertainty associated with the average temperature of the test bed of stem:[u(hat(theta_0)) = 0.2 " °C"] <<JCGM-100,clause=H.1.3.4>>.


======  Interpretation

Assign a Gaussian distribution stem:[N(mu,sigma^2)] (see <<scls_6-4-7>>) to stem:[theta_0], with

[stem%unnumbered]
++++
mu = - 0.1 " °C", " " sigma = 0.2 " °C"
++++

NOTE: There is no information about the source of the evaluation of the uncertainty and so a Gaussian distribution is assigned. Also see <<scls_9-5-2-6-2>> note, regarding such information.


===== Effect stem:[Delta] of cyclic temperature variation

====== Information

The temperature of the test bed is reported as stem:[(19.9 +- 0.5) " °C"]. The stated maximum offset of stem:[0.5 " °C"] for is said to represent the amplitude of an approximately cyclical variation of temperature under a thermostatic system. The cyclic variation of temperature results in a U-shaped (arc sine) distribution <<JCGM-100,clause=H.1.3.4>>.


======  Interpretation

Assign an arc sine distribution stem:[U(a,b)] (see <<scls_6-4-6>>) to, with limits

[stem%unnumbered]
++++
a = -0.5 " °C", " " b = 0.5 " °C".
++++

NOTE: There is no information about the reliability of the limits and so a U-shaped distribution with exactly known limits is assigned. As in <<scls_9-5-2-6-2>> note, such information may have been omitted from the description in the GUM.


===== Difference stem:[delta alpha] in expansion coefficients

====== Information

The estimated bounds on the variability of stem:[delta alpha] are stem:[+- 1 xx 10^{-6} " °C"^{-1}], with an equal probability of stem:[delta alpha] having
any value within those bounds <<JCGM-100,clause=H.1.3.5>>. These bounds are deemed to be reliable to 10 %, giving stem:[nu(u(hat(delta alpha)) = 50] <<JCGM-100,clause=H.1.6>>.


======  Interpretation

Assign a rectangular distribution with inexactly prescribed limits (see <<scls_6-4-3>>) to stem:[delta alpha], with

[stem%unnumbered]
++++
a = -1.0 xx 10^{-6} " °C"^{-1}, " " b = 1.0 xx 10^{-6} " °C"^{-1}, " " d = 0.1 xx 10^{-6} " °C"^{-1}.
++++

The stated reliability of 10 % on the estimated bounds provides the basis for this value of stem:[d].


===== Difference stem:[delta theta] in temperatures

======  Information

The reference standard and the gauge block being calibrated are expected to be at the same temperature, but the temperature difference stem:[delta theta] could lie with equal probability anywhere in the estimated interval stem:[-0.05 " °C"] to stem:[0.05 " °C"] <<JCGM-100,clause=H.1.3.6>>. This difference is believed to be reliable only to 50 %, giving stem:[nu(u(hat(delta theta))) = 2] <<JCGM-100,clause=H.1.6>>.


======  Interpretation

Assign a rectangular distribution with inexactly prescribed limits (see <<scls_6-4-3>>) to stem:[delta theta], with

[stem%unnumbered]
++++
a = -0.050 " °C", " " b = 0.050 " °C", " " d = 0.025 " °C".
++++

The stated reliability of 50 % provides the basis for this value of stem:[d].


==== Propagation and summarizing

===== The GUM uncertainty framework

The application of the GUM uncertainty framework is based on

* a first-order Taylor series approximation to the model <<eq36,(36)>> or <<eq37,(37)>>,
* use of the Welch-Satterthwaite formula to evaluate an effective degrees of freedom (rounded towards zero) associated with the uncertainty obtained from the law of propagation of uncertainty, and
* assigning a scaled and shifted stem:[t]-distribution with the above degrees of freedom to the output quantity.


===== Monte Carlo method

The application of MCM

* requires sampling from a rectangular distribution (see <<scls_6-4-2-4>> and <<scls_C-3-3>>), Gaussian distribution (see <<scls_6-4-7-4>> and <<scls_C-4>>), stem:[t]-distribution (see <<scls_6-4-9-5>> and <<scls_C-6>>), U-shaped distribution (see <<scls_6-4-6-4>>), and rectangular distribution with inexactly prescribed limits (see <<scls_6-4-3-4>>), and

* implements adaptive MCM (see <<scls_7-9>>) with a numerical tolerance (stem:[delta = 0.5]) set to deliver stem:[n_{"dig"} = 2] significant decimal digits in the standard uncertainty.


==== Results

[[scls_9-5-4-1]]
===== {blank}

<<table11>> gives the results obtained for the approximate model <<eq37,(37)>> using the information summarized in <<table10>>. <<fig17>> shows the PDFs for stem:[delta L] obtained from the application of the GUM uncertainty framework (solid curve) and MCM (scaled frequency distribution). The distribution obtained from the GUM uncertainty framework is a stem:[t]-distribution with stem:[nu = 16] degrees of freedom. The endpoints of the shortest 99 % coverage intervals for stem:[delta L] obtained from the PDFs, which are indicated as vertical lines, are visually indistinguishable.


===== {blank}

stem:[1.26 xx 10^6] trials were taken by the adaptive Monte Carlo procedure. The calculations were also carried out for a coverage probability of 95 %, for which stem:[0.53 xx 10^6] trials were taken.

[[table11]]
.Results obtained for the approximate model <<eq37,(37)>> using the information summarized in <<table10>> (<<scls_9-5-4-1>>, <<scls_9-5-4-3>>)
[cols="4*",options="header"]
|===
| Method | stem:[hat(delta L)//rm(nm)] | stem:[u(hat(delta L))//rm(nm)] | Shortest 99 % coverage interval for stem:[delta L//rm(nm)]

| GUF | 838 | 32 | [745, 931]
| MCM | 838 | 36 | [745, 932]
|===


[[fig17]]
.PDFs for stem:[delta L] obtained using the GUM uncertainty framework (continuous bell-shaped curve) and MCM (scaled histogram) for the approximate model <<eq37,(37)>> using the information summarized in <<table10>> (<<scls_9-5-4-1>>)
image::figure17.png[]


[[scls_9-5-4-3]]
===== {blank}

Results obtained for the non-linear model <<eq36,(36)>> are identical to the results in <<table11>> to the number of decimal digits given there.


===== {blank}

There are some modest differences in the results obtained. stem:[u(hat(delta L))] was 4 nm greater for the application of MCM than for the GUM uncertainty framework. The length of the 99 % coverage interval for stem:[delta L] was 1 nm greater.

These results apply equally to the non-linear and the approximate models. Whether such differences are important has to be judged in terms of the manner in which the results are to be used.
