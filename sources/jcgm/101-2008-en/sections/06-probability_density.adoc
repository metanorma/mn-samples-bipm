
== Probability density functions for the input quantities

=== General

==== {blank}

This clause gives guidance on the assignment, in some common circumstances, of PDFs to the input quantities stem:[X_i] in the formulation stage of uncertainty evaluation. Such an assignment can be based on Bayes' theorem <<Gelman2004>> or the principle of maximum entropy <<Cox-Harris2006>>, <<Jaynes1989>>, <<Weise1992>>, <<Woger1987>>.


NOTE: In some circumstances, another approach for assigning a PDF may be useful. In any case, as in any scientific discipline, the reason for the decision should be recorded.


==== {blank}

Generally, a joint PDF stem:[g_X (xi)] is assigned to the input quantities stem:[bb(X) = (ii(X)_1,..., ii(X)_N )^{sf(T)}]. See <<scls_6-4-8-4>> <<note2_6-4-8-4>>.


==== {blank}

When the stem:[X_i] are independent, PDFs stem:[g_{X_i} (xi_i)] are assigned individually based on an analysis of a series of indications (Type A evaluation of uncertainty) or based on scientific judgement using information <<Taylor1994>> such as historical data, calibrations, and expert judgement (Type B evaluation of uncertainty) <<JCGM-100,clause=3.3.5>>.


==== {blank}

When some of the stem:[X_i] are mutually independent, PDFs are assigned individually to them and a joint PDF to the remainder.

NOTE: It may be possible to remove some or all dependencies by re-expressing relevant input quantities in terms of more fundamental independent input quantities on which the original input quantities depend <<JCGM-100,clause=F1.2.4, H.1.2>>. Such changes can simplify both the application of the law of propagation of uncertainty and the propagation of distributions. Details and examples are available <<EA1999>>,


==== {blank}

Information relevant to the assignment of PDFs to the stem:[X_i] is contained in the GUM <<JCGM-100,clause=4.3>>.


==== {blank}

Comprehensive guidance on the assignment of PDFs individually or jointly to the stem:[X_i] is beyond the scope of this Supplement. Such assigned PDFs encode the knowledge and expertise of the metrologist who formulates the model and who is ultimately responsible for the quality of the final results.


==== {blank}

A standard text on probability distributions is Evans, Hastings and Peacock <<Evans2000>>.


=== Bayes' theorem

==== {blank}

Suppose that information about an input quantity stem:[ii(X)] consists of a series of indications regarded as realizations of independent, identically distributed random variables characterized by a specified PDF, but with unknown expectation and variance. Bayes' theorem can be used to calculate a PDF for stem:[ii(X)], where stem:[ii(X)] is taken to be equal to the unknown average of these random variables. Calculation proceeds in two steps. First, a non-informative joint prior (pre-data) PDF is assigned to the unknown expectation and variance. Using Bayes' theorem, this joint prior PDF is then updated, based on the information supplied by the series of indications, to yield a joint posterior (post-data) PDF for the two unknown parameters. The desired posterior PDF for the unknown average is then calculated as a marginal PDF by integrating over the possible values of the unknown variance (see <<scls_6-4-9-2>>).


==== {blank}

With the use of Bayes' theorem, the updating is carried out by forming the product of a likelihood function and the prior PDF <<Gelman2004>>. The likelihood function, in the case of indications obtained independently, is the product of functions, one function for each indication and identical in form, e.g. to a Gaussian PDF. The posterior PDF is then determined by integrating the product of prior PDF and likelihood over all possible values of the variance and normalizing the resulting expression.

NOTE: In some cases (e.g. as in <<scls_6-4-11>>), the random variables, of which the indications are regarded as realizations, are characterized by a PDF with only one parameter. In such cases, a non-informative prior PDF is assigned to the unknown expectation of the random variables, and the posterior distribution for stem:[ii(X)] is given directly by Bayes' theorem, without the need for marginalisation.

NOTE: Bayes' theorem can also be applied in other circumstances, e.g. when the expectation and standard deviation are unknown and equal.


=== Principle of maximum entropy

==== {blank}

When using the principle of maximum entropy, introduced by Jaynes <<Jaynes1957>>, a unique PDF is selected among all possible PDFs having specified properties, e.g. specified central moments of different orders or specified intervals for which the PDF is non-zero. This method is particularly useful for assigning PDFs to quantities for which a series of indications is not available or to quantities that have not explicitly been measured at all.


==== {blank}

In applying the principle of maximum entropy, to obtain a PDF stem:[g_X (xi)] that adequately characterizes incomplete knowledge about a quantity stem:[ii(X)] according to the information available, the functional

[stem%unnumbered]
++++
ii(S)[g] = - int g_X (xi) ln g_X (xi) " d"xi,
++++

the "information entropy", introduced by Shannon <<Shannon1948>>, is maximized under constraints given by the information.


[[scls_6-4]]
=== Probability density function assignment for some common circumstances

[[scls_6-4-1]]
==== General

Subclauses <<scls_6-4-2>> to <<scls_6-4-11>> provide assignments of PDFs to quantities based on various types of information regarding those quantities. Given for each PDF stem:[g_X (xi)] are

. formulae for the expectation and variance of stem:[ii(X)], and
. the manner in which sampling from stem:[g_X (xi)] can be undertaken.

<<table1>> facilitates the use of these subclauses and also illustrates the corresponding PDFs.

NOTE: These illustrations of the PDFs are not drawn to scale. The multivariate Gaussian PDF is not illustrated.


[[scls_6-4-2]]
==== Rectangular distributions

[[scls_6-4-2-1]]
===== {blank}

If the only available information regarding a quantity stem:[ii(X)] is a lower limit a and an upper limit stem:[b] with stem:[a < b], then, according to the principle of maximum entropy, a rectangular distribution stem:[R(a, b)] over the interval stem:[[a,b\]] would be assigned to stem:[ii(X)].


===== {blank}

The PDF for stem:[ii(X)] is 

[stem%unnumbered]
++++
g_X (xi) = { ({:1//(b-a),:},{:a <= xi <= b,:}),({:0,:},{:"otherwise.":}) :}
++++


===== {blank}

stem:[ii(X)] has expectation and variance

[[eq2]]
[stem]
++++
ii(E)(ii(X)) = {a + b}/2, " " ii(V)(ii(X)) = {(b - a)^2}/12.
++++


[[scls_6-4-2-4]]
===== {blank}

To sample from stem:[R(a, b)], make a draw stem:[r] from the standard rectangular distribution stem:[R(0, 1)] (see <<scls_C-3-3>>), and form

[stem%unnumbered]
++++
xi = a + (b - a)r.
++++


[[scls_6-4-3]]
==== Rectangular distributions with inexactly prescribed limits

[[scls_6-4-3-1]]
===== {blank}

A quantity stem:[ii(X)] is known to lie between limits stem:[A] and stem:[B] with stem:[A < B], where the midpoint stem:[(A + B)//2] of the interval defined by these limits is fixed and the length stem:[B - A] of the interval is not known exactly. stem:[A] is known to lie in the interval stem:[a +- d] and stem:[B] in stem:[b +- d], where stem:[a], stem:[b] and stem:[d], with stem:[d > 0] and stem:[a + d < b - d], are specified. If no other information is available concerning stem:[ii(X)], stem:[A] and stem:[B], the principle of maximum entropy can be applied to assign to stem:[ii(X)] a "curvilinear trapezoid" (a rectangular distribution with inexactly prescribed limits).


===== {blank}

The PDF for stem:[ii(X)] is

[[eq3]]
[stem]
++++
g_X (xi) = 1/{4d} { ({:ln[(w + d)//(x - xi)],:},{:a - d <= xi <= a + d,:}),
({:ln[(w + d)//(w - d)],:},{:a + d < xi < b - d,:}),
({:ln[(w + d)//(xi - x)],:},{:b - d <= xi <= b + d,:}),
({:0,:},{:"otherwise",:}) :}
++++


where stem:[x = (a + b)//2] and stem:[w = (b - a)//2] are, respectively, the midpoint and semi-width of the interval stem:[[a,b\]] <<JCGM-100,clause=4.3.9 note 2>>. This PDF is trapezoidal-like, but has flanks that are not straight lines.


[[table1]]
.Available information and the PDF assigned on the basis of that information (<<scls_6-4-1>>, <<scls_C-1-2>>)
[cols="4*",options="header"]
|===
| Available information 2+| Assigned PDF and illustration (not to scale) | Subclause

| Lower and upper limits stem:[a," "b]
| Rectangular: stem:[R(a, b)]
a| image::figure-table1-1.png[]
| <<scls_6-4-2>>


| Inexact lower and upper limits stem:[a +- d], stem:[b +- d]
| Curvilinear trapezoid: stem:["CTrap"(a, b, d)]
a| image::figure-table1-2.png[]
| <<scls_6-4-3>>


| Sum of two quantities assigned rectangular distributions with lower and upper limits stem:[a_1], stem:[b_1] and stem:[a_2], stem:[b_2]
a| Trapezoidal: +
stem:["Trap"(a, b, beta)] with stem:[a = a_1 + a_2], +
stem:[b = b_1 + b_2], +
stem:[beta = \|(b_1 - a_1) - (b_2 - a_2)\|//(b - a)]
a| image::figure-table1-3.png[]
| <<scls_6-4-4>>


| Sum of two quantities assigned rectangular distributions with lower and upper limits stem:[a_1], stem:[b_1] and stem:[a_2], stem:[b_2] and the same semi-width (stem:[b_1 - a_1 = b_2 - a_2])
a| Triangular: +
stem:[T(a, b)] with stem:[a = a_1 + a_2, b = b_1 + b_2]
a| image::figure-table1-4.png[]
| <<scls_6-4-5>>


| Sinusoidal cycling between lower and upper limits a, b
a| Arc sine (U-shaped): +
stem:[U(a, b)]
a| image::figure-table1-5.png[]
| <<scls_6-4-6>>


| Best estimate stem:[x] and associated standard uncertainty stem:[u(x)]
| Gaussian: +
stem:[N(x, u^2(x))]
a| image::figure-table1-6.png[]
| <<scls_6-4-7>>


| Best estimate stem:[bb(x)] of vector quantity and associated uncertainty matrix stem:[bb(U_x)]
| Multivariate Gaussian: +
stem:[N(bb(x), bb(U_x))]
|
| <<scls_6-4-8>>

| Series of indications stem:[x_1,..., x_n] sampled independently from a quantity having a Gaussian distribution, with unknown expectation and unknown variance
a| Scaled and shifted stem:[t]: +
stem:[t_{n-1}(hat(x),s^2//n)] with hat(x) = sum_{i=1}^n x_i//n, +
s^2 = sum_{i=1}^n (x_i hat(x))^2//(n-1)
a| image::figure-table1-7.png[]
| <<scls_6-4-9-2>>

| Best estimate stem:[x], expanded uncertainty stem:[U_{"p"}], coverage factor stem:[k_{"p"}] and effective degrees of freedom stem:[nu_{"eff"}]
a| Scaled and shifted stem:[t]: +
stem:[t_{nu_{"eff"}}(x,(U_{"p"}//k_{"p"})^2)]
a| image::figure-table1-8.png[]
| <<scls_6-4-9-7>>


| Best estimate stem:[x] of non-negative quantity
| Exponential: +
stem:[Ex(1/x)]
a| image::figure-table1-9.png[]
| <<scls_6-4-10>>


| Number stem:[q] of objects counted
| Gamma: +
stem:[G(q + 1, 1)]
a| image::figure-table1-10.png[]
| <<scls_6-4-11>>
|===


[NOTE]
====
<<eq3>> can be expressed as

[stem%unnumbered]
++++
g_X (xi) = 1/{4d} max(ln{:{w+d}/{max(|:xi-x:|,w-d)}:},0)
++++

for computer implementation.
====


[[scls_6-4-3-3]]
===== {blank}

stem:[ii(X)] has expectation and variance

[[eq4]]
[stem]
++++
ii(E)(ii(X)) = {a+b}/2, " " ii(V)(ii(X)) = (b-a)^2/12 + d^2/9.
++++

NOTE: The variance in <<eq4>> is always greater than the variance holding for exact limits in <<eq2>>, i.e. when stem:[d = 0].

[[note2_6-4-3-3]]
NOTE: The GUM treats the information about stem:[ii(X)] in <<scls_6-4-3-1>> by assigning a degrees of freedom to the standard uncertainty associated with the best estimate of stem:[ii(X)] <<JCGM-100,clause=G.4.2>>.


[[scls_6-4-3-4]]
===== {blank}

To sample from stem:["CTrap"(a, b, d)], make two draws stem:[r_1] and stem:[r_2] independently from the standard rectangular distribution stem:[R(0, 1)] (see <<scls_C-3-3>>), and form

[stem%unnumbered]
++++
a_s = (a - d) + 2dr_1, " " " " b_s = (a + b) - a_s,
++++

and

[stem%unnumbered]
++++
xi = a_s + (b_s - a_s) r_2.
++++

NOTE: stem:[a_s] is a draw from the rectangular distribution with limits stem:[a +- d]. stem:[b_s] is then formed to ensure that the midpoint of a_s and b_s is the prescribed value stem:[x = (a + b)//2].


[example]
====
A certificate states that a voltage stem:[ii(X)] lies in the interval stem:[10.0 " "rm(V) +- 0.1 " "rm(V)]. No other information is available concerning stem:[ii(X)], except that it is believed that the magnitude of the interval endpoints is the result of rounding correctly some numerical value (see <<scls_3-20>>). On this basis, that numerical value lies between 0.05 V and 0.15 V, since the numerical value of every point in the interval (0.05, 0.15) rounded to one significant decimal digit is 0.1. The location of the interval can therefore be regarded as fixed, whereas its width is inexact. The best estimate of stem:[ii(X)] is stem:[x = 10.0" "rm(V)] and, using <<eq4>> based on stem:[a = 9.9" "rm(V)], stem:[b = 10.1" "rm(V)] and stem:[d = 0.05" "rm(V)], the associated standard uncertainty stem:[u(x)] is given by

[stem%unnumbered]
++++
u^2 (x) = (0.2)^2/12 + (0.05)^2 = 0.0036.
++++

Hence stem:[u(x) = (0.0036)^{1//2} = 0.060 " "rm(V)], which can be compared with stem:[0.2//sqrt(12) = 0.058 " "rm(V)] in the case of exact limits, given by replacing stem:[d] by zero. The use of exact limits in this case gives a numerical value for stem:[u(x)] that is 4 % smaller than that for inexact limits. The relevance of such a difference needs to be considered in the context of the application.
====


[[scls_6-4-4]]
==== Trapezoidal distributions

===== {blank}

The assignment of a symmetric trapezoidal distribution to a quantity is discussed in the GUM <<JCGM-100,clause=4.3.9>>. Suppose a quantity stem:[ii(X)] is defined as the sum of two independent quantities stem:[ii(X)_1] and stem:[ii(X)_2]. Suppose, for stem:[i = 1] and stem:[i = 2], stem:[X_i] is assigned a rectangular distribution stem:[R(a_i, b_i)] with lower limit stem:[a_i] and upper limit stem:[b_i]. Then the distribution for stem:[ii(X)] is a symmetric trapezoidal distribution stem:["Trap"(a, b, beta)] with lower limit stem:[a], upper limit stem:[b], and stem:[a] parameter stem:[beta] equal to the ratio of the semi-width of the top of the trapezoid to that of the base. The parameters of this trapezoidal distribution are related to those of the rectangular distributions by

[[eq5]]
[stem]
++++
a = a_1 + a_2, " " b = b_1 + b_2, " " " "beta = lambda_1/lambda_2,
++++

where

[[eq6]]
[stem]
++++
lambda_1 = {|(b_1 - a_1) - (b_2 - a_2)|}/2, " " " " lambda_2 = {b - a}/2,
++++

and

[stem%unnumbered]
++++
0 <= lambda_1 <= lambda_2.
++++


[[scls_6-4-4-2]]
===== {blank}

The PDF for stem:[ii(X)] (<<fig5>>), obtained using convolution <<Rice1995,page=93>>, is

[[eq7]]
[stem]
++++
g_X (xi) = { (({:xi - x + lambda_2)//(lambda_2^2 - lambda_1^2),:},{:x - lambda_2 <= xi <= x - lambda_1,:}),
({:1//(lambda_1 + lambda_2),:},{:x - lambda_1 <= xi <= x + lambda_1,:}),
({:(x + lambda_2 - xi)//(lambda_2^2 - lambda_1^2),:},{:x + lambda_1 < xi <= x + lambda_2,:}),
({:0,:},{:"otherwise",:}) :}
++++


where stem:[x = (a + b)//2].


[NOTE]
====
<<eq7>> can be expressed as 

[stem%unnumbered]
++++
g_X (xi) = 1/{lambda_1 + lambda_2} min(1/{lambda_2 - lambda_1} max(lambda_2 - |xi - x|,0), 1)
++++

for computer implementation. 
====


[[fig5]]
.The trapezoidal PDF for stem:[bb(X) = ii(X)_1 + ii(X)_2], where the PDFs for stem:[ii(X)_1] and stem:[ii(X)_2] are rectangular (<<scls_6-4-4-2>>)
image::figure5.png[]


===== {blank}

stem:[ii(X)] has expectation and variance 

[stem%unnumbered]
++++
ii(E)(ii(X)) = {a + b}/2, " " ii(V)(ii(X)) = {(b - a)^2}/24 (1 + beta^2).
++++


===== {blank}

To sample from stem:["Trap"(a, b, beta)], make two draws stem:[r_1] and stem:[r_2] independently from the standard rectangular distribution stem:[R(0, 1)] (see <<scls_C-3-3>>), and form

[stem%unnumbered]
++++
xi = a + {b - a}/2 [(1 + beta)r_1 + (1 + beta)r_2].
++++


[[scls_6-4-5]]
==== Triangular distributions

===== {blank}

Suppose a quantity stem:[ii(X)] is defined as the sum of two independent quantities, each assigned a rectangular distribution (see <<scls_6-4-4>>), but with equal semi-widths, i.e. stem:[b_1 - a_1 = b_2 - a_2]. It follows from <<eq5>> and <<eq6>> that stem:[lambda_1 = 0] and stem:[beta = 0]. The distribution for stem:[ii(X)] is the trapezoidal distribution stem:["Trap"(a, b, 0)], which reduces to the (symmetric) triangular distribution stem:[T(a, b)] over the interval stem:[[a,b\]].


===== {blank}

The PDF for stem:[ii(X)] is

[[eq8]]
[stem]
++++
g_X (xi) = { ({: (xi - a)//w^2, :},{: a <= xi <= x, :}),
({: (b - xi)//w^2, :},{: x < xi <= b, :}),
({: 0, :},{: "otherwise", :}) :}
++++

where stem:[x = (a + b)//2] and stem:[w = lambda_2 = (b - a)//2].

[NOTE]
====
<<eq8>> can be expressed as

[stem%unnumbered]
++++
g_X (xi) = 2/{b - a} max(1 - {2|xi - x|}/{b - a}, 0).
++++

for computer implementation.
====


===== {blank}

stem:[ii(X)] has expectation and variance

[stem%unnumbered]
++++
ii(E)(ii(X)) = {a + b}/2, " " ii(V)(ii(X)) = {(b - a)^2}/24.
++++


===== {blank}

To sample from stem:[T(a, b)], make two draws stem:[r_1] and stem:[r_2] independently from the standard rectangular distribu-tion stem:[R(0, 1)] (see <<scls_C-3-3>>), and form

[stem%unnumbered]
++++
xi = a + {b - a}/2 (r_1 + r_2).
++++


[[scls_6-4-6]]
==== Arc sine (U-shaped) distributions

===== {blank}

If a quantity stem:[ii(X)] is known to cycle sinusoidally, with unknown phase stem:[ii(Phi)], between specified limits stem:[a] and stem:[b], with stem:[a < b], then, according to the principle of maximum entropy, a rectangular distribution stem:[R(0,2pi)] would be assigned to stem:[ii(Phi)]. The distribution assigned to stem:[ii(X)] is the arc sine distribution stem:[U(a, b)] <<Evans2000>>, given by the transformation

[stem%unnumbered]
++++
X = {a + b}/2 + {b - a}/2 sin ii(Phi),
++++

where stem:[ii(Phi)] has the rectangular distribution stem:[R(0,2pi)].


===== {blank}

The PDF for stem:[ii(X)] is

[stem%unnumbered]
++++
g_X (xi) = { ({: (2//pi)[(b - a)^2 - (2xi - a - b)^2]^{-1//2}, :},{: a < xi < b, :}),
({: 0, :},{: "otherwise". :}) :}
++++

[NOTE]
====
stem:[U(a,b)] is related to the standard arc sine distribution stem:[U(0,1)] given by

[[eq9]]
[stem]
++++
g_Z (z) = { ({: [z(1 - z)]^{-1//2}//pi, :},{: 0 < z < 1, :}),
({: 0, :},{: "otherwise", :}) :}
++++

in the variable stem:[ii(Z)], through the linear transformation

[stem%unnumbered]
++++
X = a + (b - a)ii(Z).
++++

stem:[ii(Z)] has expectation 1/2 and variance 1/8. The distribution <<eq9,(9)>> is termed the arc sine distribution, since the corresponding distribution function is

[stem%unnumbered]
++++
G_Z (z) = 1/pi arcsin (2z - 1) + 1/2.
++++

It is a special case of the beta distribution with both parameters equal to one half.
====


===== {blank}

stem:[ii(X)] has expectation and variance

[stem%unnumbered]
++++
ii(E)(ii(X)) = {a + b}/2, " " ii(V)(ii(X)) = {(b - a)^2}/8.
++++


===== {blank}

To sample from stem:[U(a, b)], make a draw stem:[r] from the standard rectangular distribution stem:[R(0, 1)] (see <<scls_C-3-3>>), and form

[stem%unnumbered]
++++
xi = {a + b}/2 + {b - a}/2 sin 2pir.
++++


[[scls_6-4-7]]
==== Gaussian distributions

[[scls_6-4-7-1]]
===== {blank}

If a best estimate stem:[x] and associated standard uncertainty stem:[u(x)] are the only information available regarding a quantity stem:[ii(X)], then, according to the principle of maximum entropy, a Gaussian probability distribution stem:[N(x, u^2(x))] would be assigned to stem:[ii(X)].


===== {blank}

The PDF for stem:[ii(X)] is

[[eq10]]
[stem]
++++
g_X (xi) = 1/{sqrt(2pi)u(x)} exp(-{(xi - x)^2}/{2u^2(x)}).
++++


===== {blank}

stem:[ii(X)] has expectation and variance

[stem%unnumbered]
++++
ii(E)(ii(X)) = x, " " ii(V)(ii(X)) = u^2(x).
++++


[[scls_6-4-7-4]]
===== {blank}

To sample from stem:[N(x,u^2(x))], make a draw stem:[z] from the standard Gaussian distribution stem:[N(0,1)] (see <<scls_C-4>>), and form

[stem%unnumbered]
++++
xi = x + u(x)z.
++++


[[scls_6-4-8]]
==== Multivariate Gaussian distributions

[[scls_6-4-8-1]]
===== {blank}

A comparable result to that in <<scls_6-4-7-1>> holds for an stem:[ii(N)]-dimensional quantity stem:[bb(X) = (ii(X)_1,..., ii(X)_N )^{sf(T)}]. If the only information available is a best estimate stem:[bb(x) = (x_1,..., x_N )^{sf(T)}] of stem:[bb(X)] and the associated (strictly) positive definite uncertainty matrix

[stem%unnumbered]
++++
bb(U_x) = [({: u^2(x_1) :},{: u(x_1,x_2) :},{: cdots :},{: u(x_1,x_N) :}),
({: u(x_2,x_1) :},{: u^2(x_2) :},{: cdots :},{: u(x_2,x_N) :}),
({: vdots :},{: vdots :},{: ddots :},{: vdots :}),
({: u(x_N,x_1) :},{: u(x_N,x_2) :},{: cdots :},{: u^2(x_N) :})],
++++

a multivariate Gaussian distribution stem:[N(bb(x),bb(U_x))] would be assigned to stem:[bb(X)].


===== {blank}

The joint PDF for stem:[bb(X)] is

[[eq11]]
[stem]
++++
g_X (xi) = 1/{[(2pi)^N det bb(U_x)]^{1//2}} exp (-1/2 (bb(xi - x))^{sf(T)} bb(U_x)^{-1} (bb(xi - x))).
++++


===== {blank}

stem:[ii(X)] has expectation and covariance matrix

[stem%unnumbered]
++++
E(bb(X)) = x, " " V (bb(X)) = bb(U_x).
++++


[[scls_6-4-8-4]]
===== {blank}

To sample from stem:[N(x,U_x)], make N draws stem:[z_i], stem:[i = 1,...,N], independently from the standard Gaussian distribution N(0, 1) (see <<scls_C-4>>), and form

[stem%unnumbered]
++++
bb(xi) = bb(x) + bb(R)^{sf(T)} bb(z),
++++

where stem:[bb(z) = (z_1,...,z_N)^{sf(T)}] and stem:[bb(R)] is the upper triangular matrix given by the Cholesky decomposition stem:[bb(U_x) = bb(R)^{sf(T)} bb(R)] (see <<scls_C-5>>).


NOTE: In place of the Cholesky decomposition stem:[bb(U_x) = bb(R)^{sf(T)} bb(R)], any matrix factorization of this form can be used.

[[note2_6-4-8-4]]
NOTE: The only joint PDFs considered explicitly in this Supplement are multivariate Gaussian, distributions commonly used in practice. A numerical procedure for sampling from a multivariate Gaussian PDF is given above (and in <<scls_C-5>>). If another multivariate PDF is to be used, a means for sampling from it would need to be provided.

[NOTE]
====
The multivariate Gaussian PDF <<eq11>> reduces to the product of N univariate Gaussian PDFs when there are no covariance effects. In that case

[stem%unnumbered]
++++
bb(U_x) = "diag"(u^2 (x_1),..., u^2 (x_N)),
++++

whence

[stem%unnumbered]
++++
g_bb(X) (bb(xi)) = prod_{i=1}^N g_{X_i} (xi),
++++

with

[stem%unnumbered]
++++
g_{X_i} (xi_i) = 1/{sqrt(2 pi) (x_i)} exp(- {(xi - x_i)^2}/{2u^2(x_i)}).
++++

====

==== stem:[t]-distributions

===== {blank}

stem:[t]-distributions typically arise in two circumstances: the evaluation of a series of indications (see <<scls_6-4-9-2>>), and the interpretation of calibration certificates (see <<scls_6-4-9-7>>).


[[scls_6-4-9-2]]
===== {blank}

Suppose that a series of stem:[n] indications stem:[x_1,..., x_n] is available, regarded as being obtained independently from a quantity with unknown expectation stem:[mu_0] and unknown variance stem:[sigma_0^2] having Gaussian distribution stem:["N"(mu_0,sigma_0^2)]. The desired input quantity stem:[ii(X)] is taken to be equal to stem:[mu_0]. Then, assigning a non-informative joint prior distribution to stem:[mu_0] and stem:[sigma_0^2], and using Bayes' theorem, the marginal PDF for stem:[ii(X)] is a scaled and shifted stem:[t]-distribution stem:[t_{nu}(bar(x), s^2//n)] with stem:[nu = n - 1] degrees of freedom, where

[stem%unnumbered]
++++
bar(x) = 1/n sum_{i=1}^n x_i, " " s^2 = 1/{n - 1} sum_{i=1}^n (x_i - bar(x))^2,
++++

being, respectively, the average and variance of the indications <<Gelman2004>>.


===== {blank}

The PDF for stem:[ii(X)] is

[[eq12]]
[stem]
++++
g_X (xi) = {Gamma (n//2)}/{Gamma((n-1)//2)sqrt((n - 1)pi)} times 1/{s//sqrt(n)} (1 + 1/{n - 1} ({xi - bar(x)}/{s//sqrt(n)}))^{-n//2},
++++

where

[stem%unnumbered]
++++
Gamma (z) = int_{0}^{oo} t^{z - 1} e^{-t} " d"t, " " " " z > 0
++++

is the gamma function.


===== {blank}

stem:[ii(X)] has expectation and variance

[stem%unnumbered]
++++
ii(E)(ii(X)) = bar(x), " " ii(V)(ii(X)) = {n - 1}/{n - 3} {s^2}/n,
++++


where stem:[ii(E)(ii(X))] is defined only for stem:[n > 2] and stem:[ii(V)(ii(X))] only for stem:[n > 3]. For stem:[n > 3], the best estimate of stem:[ii(X)] and its associated standard uncertainty are therefore

[[eq13]]
[stem]
++++
x = bar(x), " " u(x) = sqrt({n - 1}/{n - 3}) s/{sqrt(n)}.
++++


NOTE: In the GUM <<JCGM-100,clause=4.2>>, the standard uncertainty stem:[u(x)] associated with the average of a series of stem:[n] indications obtained independently is evaluated as stem:[u(x) = s//n], rather than from <<eq13>>, and the associated degrees of freedom stem:[nu = n - 1] is considered as a measure of the reliability of stem:[u(x)]. By extension, a degrees of freedom is associated with an uncertainty obtained from a Type B evaluation, based on subjective judgement of the reliability of the evaluation <<JCGM-100,clause=G.4.2>> (cf. <<scls_6-4-3-3>> <<note2_6-4-3-3>>). Degrees of freedom associated with the uncertainties stem:[u(x_i)] are necessary to obtain, by application of the Welch-Satterthwaite formula, the effective degrees of freedom stem:[nu_{"eff"}] associated with the uncertainty stem:[u(y)].

NOTE: In the Bayesian context of this Supplement, concepts such as the reliability, or the uncertainty, of an uncertainty are not necessary. Accordingly, the degrees of freedom in a Type A evaluation of uncertainty is no longer viewed as a measure of reliability, and the degrees of freedom in a Type B evaluation does not exist.


[[scls_6-4-9-5]]
===== {blank}

To sample from stem:[t_{nu}(bar(x),s^2//n)], make a draw stem:[t] from the central stem:[t]-distribution stem:[t_{nu}] with stem:[nu = n - 1] degrees of freedom <<JCGM-100,clause=G.3>> (also see <<scls_C-6>>), and form

[stem%unnumbered]
++++
xi = bar(x) + s/{sqrt(n)} t.
++++


[[scls_6-4-9-6]]
===== {blank}

If instead of a standard deviation stem:[s] calculated from a single series of indications, a pooled standard deviation stem:[s_p] with stem:[nu_p] degrees of freedom obtained from stem:[Q] such sets,

[stem%unnumbered]
++++
s_{"p"}^2 = 1/{nu_{"p"}} sum_{j=1}^Q nu_j s_j^2, " " nu_{"p"} = sum_{j=1}^Q nu_j,
++++

is used, the degrees of freedom stem:[nu = n - 1] of the scaled and shifted stem:[t]-distribution assigned to stem:[ii(X)] should be replaced by the degrees of freedom stem:[nu_{"p"}] associated with the pooled standard deviation stem:[s_{"p"}]. As a consequence, <<eq12>> should be replaced by

[stem%unnumbered]
++++
g_X (xi) = {Gamma((nu_{"p"} + 1)//2)}/{Gamma(nu_{"p"}//2)sqrt(nu_{"p"} pi)} times 1/{s_{"p"}//sqrt(n)}[1 + 1/{nu_{"p"}}({xi - bar(x)}/{s_{"p"}//sqrt(n)})]^{-(nu_{"p"} + 1)//2}
++++

and <<eq13>> by

[stem%unnumbered]
++++
x = bar(x) = 1/n sum_{i=1}^n x_i, " " u(x) = sqrt(nu_{"p"}/{nu_{"p"} - 2}) s_{"p"}/{sqrt(n)} " " (nu_p >= 3).
++++


[[scls_6-4-9-7]]
===== {blank}

If the source of information about a quantity stem:[ii(X)] is a calibration certificate <<JCGM-100,clause=4.3.1>> in which a best estimate stem:[x], the expanded uncertainty stem:[U_p], the coverage factor stem:[k_p] and the effective degrees of freedom stem:[nu_{"eff"}] are stated, then a scaled and shifted stem:[t]-distribution stem:[t_{nu} (x, (U_p//k_p)^2)] with stem:[nu = nu_{"eff"}] degrees of freedom should be assigned to stem:[ii(X)].


===== {blank}

If stem:[nu_{"eff"}] is stated as infinite or not specified, in which case it would be taken as infinite in the absence of other information, a Gaussian distribution stem:[N(x, (U_p/k_p)^2)] would be assigned to stem:[ii(X)] (see <<scls_6-4-7-1>>).

NOTE: This distribution is the limiting case of the scaled and shifted stem:[t]-distribution stem:[t_{nu} (x, (U_p//k_p)^2)] as stem:[nu] tends to infinity.


[[scls_6-4-10]]
==== Exponential distributions

===== {blank}

If the only available information regarding a non-negative quantity stem:[ii(X)] is a best estimate stem:[x > 0] of stem:[ii(X)], then, according to the principle of maximum entropy, an exponential distribution stem:["Ex"(1//x)] would be assigned to stem:[ii(X)].


===== {blank}

The PDF for stem:[ii(X)] is

[stem%unnumbered]
++++
g_X (xi) = {({: exp(-xi//x)//x, :},{: xi >= 0, :}),({: 0, :},{: "otherwise". :}) :}
++++


===== {blank}

stem:[ii(X)] has expectation and variance

[stem%unnumbered]
++++
ii(E)(ii(X)) = x, " " ii(V)(ii(X)) = x^2.
++++


[[scls_6-4-6-4]]
===== {blank}

To sample from stem:["Ex"(1//x)], make a draw stem:[r] from the standard rectangular distribution stem:[R(0, 1)] (see <<scls_C-3-3>>), and form

[stem%unnumbered]
++++
xi = - x ln r.
++++

NOTE: Further information regarding the assignment of PDFs to non-negative quantities is available <<Dowson1973>>.


[[scls_6-4-11]]
==== Gamma distributions

===== {blank}

Suppose the quantity stem:[ii(X)] is the average number of objects present in a sample of a fixed size (e.g. the average number of particles in an air sample taken from a clean room, or the average number of photons emitted by a source in a specified time interval). Suppose stem:[q] is the number of objects counted in a sample of the specified size, and the counted number is assumed to be a quantity with unknown expectation having a Poisson distribution. Then, according to Bayes' theorem, after assigning a constant prior distribution to the expectation, a gamma distribution G(q + 1, 1) would be assigned to stem:[ii(X)].


===== {blank}

The PDF for stem:[ii(X)] is

[[eq14]]
[stem]
++++
g_X (xi) = {({: xi^q exp(-xi)//q!, :},{: xi >= 0 :}),({: 0, :},{: "otherwise". :}) :}
++++


===== {blank}

stem:[ii(X)] has expectation and variance

[[eq15]]
[stem]
++++
ii(E)(ii(X)) = q + 1, " " ii(V)(ii(X)) = q + 1.
++++


[[scls_6-4-11-4]]
===== {blank}

To sample from stem:[G(q + 1, 1)], make stem:[q + 1] draws stem:[r_i], stem:[i = 1,..., q + 1], independently from the standard rectangular distribution stem:[R(0, 1)] (see <<scls_C-3-3>>), and form <<Evans2000>>

[stem%unnumbered]
++++
xi = - ln prod_{i=1}^{q+1} r_i.
++++

NOTE: If the counting is performed over several samples (according to the same Poisson distribution), and stem:[q_i] is the number of objects counted in the __i__th sample, of size stem:[S], then the distribution for the average number of objects in a sample of size stem:[S = sum_i S_i] is stem:[G(alpha,beta)] with stem:[alpha = 1 + sum_i q_i] and stem:[beta = 1]. <<eq14>> and <<eq15>> apply with stem:[q = sum_i q_i].

NOTE: The gamma distribution is a generalization of the chi-squared distribution and is used to characterize information associated with variances.

NOTE: The particular gamma distribution in <<scls_6-4-11-4>> is an Erlang distribution given by the sum of stem:[q + 1] exponential distributions with parameter 1 <<Evans2000>>.


[[scls_6-5]]
=== Probability distributions from previous uncertainty calculations

A previous uncertainty calculation may have provided a probability distribution for an output quantity that is to become an input quantity for a further uncertainty calculation. This probability distribution may be available ana-lytically in a recognized form, e.g. as a Gaussian PDF. It may be available as an approximation to the distribution function for a quantity obtained from a previous application of MCM, for example. Means for describing such a distribution function for a quantity is given in <<scls_7-5-1>> and <<scls_D-2>>.
