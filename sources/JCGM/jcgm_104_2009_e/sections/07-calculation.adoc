
[[cls_7]]
== The calculation (propagation and summarizing) stage of uncertainty evaluation

=== General

==== {blank}

The propagation stage of uncertainty evaluation is known as the _propagation of distributions_ <<JCGM1012008,clause=5.2>>, various approaches for which are available, including

. [[item_7-1-1a]]the GUM uncertainty framework, constituting the application of the law of propagation of uncertainty, and the characterization of the output quantity stem:[ii(Y)] by a Gaussian or a stem:[t]-distribution (see <<scls_7-2>>),

. [[item_7-1-1b]]analytic methods, in which mathematical analysis is used to derive an algebraic form for the probability distribution for stem:[ii(Y)] (see <<scls_7-3>>), and

. [[item_7-1-1c]]a Monte Carlo method (MCM), in which an approximation to the distribution function for stem:[ii(Y)] is established numerically by making random draws from the probability distributions for the input quantities, and evaluating the model at the resulting values (see <<scls_7-4>>).


==== {blank}

For any particular uncertainty evaluation problem, approach <<item_7-1-1a>>, <<item_7-1-1b>> or <<item_7-1-1c>> (or some other approach) is used, <<item_7-1-1a>> being generally approximate, <<item_7-1-1b>> exact, and <<item_7-1-1c>> providing a solution with a numerical accuracy that can be controlled.


==== {blank}

The application of approaches <<item_7-1-1a>> and <<item_7-1-1c>> to measurement functions with any number of output quantities, and general measurement models, is considered in <<scls_7-5>>.


[[scls_7-2]]
=== The GUM uncertainty framework

[[scls_7-2-1]]
==== {blank}

The GUM uncertainty framework <<JCGM1002008,clause=(GUM) 3.4.8, 5.1>> (depicted in <<fig7>>) uses

. the best estimates stem:[x_i] of the input quantities stem:[ii(X)_i],
. the standard uncertainties stem:[u(x_i)] associated with the stem:[x_i], and
. the sensitivity coefficients stem:[c_i] (see <<scls_4-14>>)

to form an estimate stem:[y] of the output quantity stem:[ii(Y)] and the associated standard uncertainty stem:[u(y)].


==== {blank}

A variant <<JCGM1002008,clause=(GUM) 5.2>> of <<scls_7-2-1>> applies when the input quantities are mutually dependent (not indicated in <<fig7>>). By regarding the probability distribution for stem:[ii(Y)] as Gaussian, a coverage interval for stem:[ii(Y)] corresponding to a specified coverage probability is also determined <<JCGM1002008,clause=(GUM) G.2>>. When the degrees of freedom <<ISO_3534-1,clause=2.54>> relating to any stem:[u(x_i)] is finite, an (effective) degrees of freedom relating to stem:[u(y)] is determined, and the probability distribution for stem:[ii(Y)] taken as a stem:[t]-distribution.


==== {blank}

There are many circumstances where the GUM uncertainty framework <<JCGM1002008,clause=(GUM) 5>> can be applied and leads to valid statements of uncertainty. If the measurement function is linear in the input quantities and the probability distributions for these quantities are Gaussian, the GUM uncertainty framework provides exact results <<JCGM1012008,clause=5.7>>. Even when these conditions do not hold, the approach can often work sufficiently well for practical purposes <<JCGM1012008,clause=5.8>>.


[[scls_7-2-4]]
==== {blank}

There are situations where the GUM uncertainty framework might not be satisfactory, including those where

. the measurement function is non-linear,
. the probability distributions for the input quantities are asymmetric,
. the uncertainty contributions stem:[|c_1| u(x_1),..., |c_{ii(N)}| u(x_{ii(N)})] (see <<scls_4-14>>) are not of approximately the same magnitude <<JCGM1002008,clause=(GUM) G.2.2>>, and
. the probability distribution for the output quantity is either asymmetric, or not a Gaussian or a stem:[t]-distribution.

Sometimes it is hard to establish in advance that the circumstances hold for the GUM uncertainty framework to apply.


[[fig7]]
.Measurement uncertainty evaluation using the GUM uncertainty framework, where the top-left part of the figure (bounded by broken lines) relates to obtaining an estimate y of the output quantity stem:[ii(Y)] and the associated standard uncertainty stem:[u(y)], and the remainder relates to the determination of a coverage interval for stem:[ii(Y)]
image::figure7.png[]


==== {blank}

The use of the GUM uncertainty framework becomes more difficult when forming partial derivatives (or numerical approximations to them) for a measurement model that is complicated, as needed by the law of propagation of uncertainty (possibly with higher-order terms) <<JCGM1002008,clause=(GUM) 5>>. A valid and sometimes more readily applicable treatment is obtained by applying a suitable Monte Carlo implementation of the propagation of distributions (see <<scls_7-4>>).


[[scls_7-3]]
=== Analytic methods

[[scls_7-3-1]]
==== {blank}

Analytic methods by which an algebraic form for the probability distribution for the output quantity can be obtained do not introduce any approximation, but can be applied only in relatively simple cases. A treatment of such methods is available <<Casella2001>>, <<Dietrich1991>>. Some cases that can be so handled for a general number stem:[ii(N)] of input quantities are linear measurement functions (expression <<eq3,(3)>>), where the probability distributions for all input quantities are Gaussian, or all are rectangular with the same width. An instance with two input quantities (stem:[ii(N) = 2]), for which the probability distributions for the input quantities are rectangular, and the probability distribution for the output quantity is trapezoidal <<Cox-Harris2006>> is illustrated in <<fig3>>.


[[scls_7-3-2]]
==== {blank}

Cases where there is one input quantity (stem:[ii(N) = 1]) can often be treated analytically, using a formula <<Rice1995>>, pages 57-61, to derive algebraically a probability distribution for the output quantity. Such cases arise in the transformation of measurement units, for example from linear to logarithmic units <<Cox-Harris2006>>, pages 95-98.


==== {blank}

An advantage of an algebraic solution is that it provides insight through displaying the dependence of the probability distribution for the output quantity on parameters of the probability distributions for the input quantities.


[[scls_7-4]]
=== Monte Carlo method

==== {blank}

<<JCGM1012008>> provides detailed information on MCM as an implementation of the propagation of distributions <<JCGM1012008,clause=5.9>>. MCM has fewer conditions associated with its use than the GUM uncertainty framework <<JCGM1012008,clause=5.10>>. <<fig8>> illustrates the procedure. <<JCGM1012008>> gives examples to compare MCM with the use of the GUM uncertainty framework <<JCGM1012008,clause=9>>.


==== {blank}

<<JCGM1012008>> provides an adaptive MCM procedure, in which the number of Monte Carlo trials is determined automatically by utilizing a measure of convergence of the overall process <<JCGM1012008,clause=7.9>>.


==== {blank}

In <<JCGM1012008>> there is a procedure that uses MCM to decide whether the application of the GUM uncertainty framework in any particular case is valid <<JCGM1012008,clause=8>>.


[[fig8]]
.Measurement uncertainty evaluation using a Monte Carlo method, where the part of the figure to the left of the broken line relates to obtaining an estimate y of the output quantity stem:[ii(Y)] and the associated standard uncertainty stem:[u(y)], and the remainder relates to the determination of a coverage interval for stem:[ii(Y)]
image::figure8.png[]


[[scls_7-5]]
=== Measurement models with any number of output quantities

==== {blank}

In order to evaluate the uncertainties and covariances associated with estimates of the output quantities for measurement models with any number of output quantities, both the GUM uncertainty framework and MCM, as treated in <<JCGM1012008>>, require extension. The GUM <<JCGM1002008,clause=(GUM) F.1.2.3>> outlines such an extension of the GUM uncertainty framework, but considers it further only in examples.


[[scls_7-5-2]]
==== {blank}

In JCGM 102 <<bipm_supp2>> it is stated that the law of propagation of uncertainty, a main constituent of the GUM uncertainty framework, can succinctly be expressed in an equivalent matrix form when applied to a measurement model having a single output quantity. The matrix expression has the advantage of being suitable as a basis for implementation in software, and for extension to more general types of measurement model.


==== {blank}

That extension is given in JCGM 102 for a measurement function having any number of output quantities. The extension to any number of output quantities in a general measurement model (see <<scls_3-16>>) is also treated in JCGM 102.


==== {blank}

JCGM 102 also applies MCM to measurement models with any number of output quantities. A discrete representation of the probability distribution for the output quantities is provided. Expressions are given for the estimates of the output quantities, the standard uncertainties associated with these estimates, and the covariances associated with pairs of these estimates in terms of that representation.


==== {blank}

In addition to obtaining estimates of the output quantities, together with the associated standard uncertainties and covariances, it might be required to obtain a region containing the output quantities with a specified (coverage) probability. It is natural to consider the extension to regions of the probabilistically symmetric coverage interval and the shortest coverage interval. However, there is no natural counterpart of a probabilistically symmetric coverage interval in the form of a coverage region, whereas there is for a shortest coverage interval. The determination of a smallest coverage region is generally a difficult task.


==== {blank}

In some circumstances, it is reasonable to provide an _approximate_ coverage region having simple geometric shape. Two particular forms of coverage region are considered in this regard. One form results from characterizing the output quantities by a joint Gaussian distribution, for example on the basis of the central limit theorem <<JCGM1002008,clause=(GUM) G.2>>, in which case the smallest coverage region is bounded by a hyper-ellipsoid. The other form constitutes a hyper-rectangular coverage region. Procedures for obtaining these forms are provided in JCGM 102.
