

[[annexD]]
[appendix]
== Continuous approximation to the distribution function for the output quantity

[[scls_D-1]]
=== {blank}

It is sometimes useful to work with a continuous approximation stem:[tilde(G)_Y (eta)], say, to the distribution function for the output quantity stem:[ii(Y)], rather than the discrete representation stem:[bb(G)] of <<scls_7-5>>.


[NOTE]
====
Working with a continuous approximation means, for instance, that

. sampling from the distribution function can be carried out without the need for rounding, as in the discrete case, and
. numerical methods that require continuity for their operation can be used to determine the shortest coverage interval.
====


[[scls_D-2]]
=== {blank}

In order to form stem:[tilde(G)_Y(eta)], consider the discrete representation stem:[bb(G) = {y_{(r)}], stem:[r = 1,..., ii(M)}] of stem:[G_Y (eta)] in <<scls_7-5-1>>, after replacing replicate model values of stem:[y_{(r)}] as necessary (step b) in that subclause). Then, carry out the following steps:

. assign uniformly spaced cumulative probabilities stem:[p_r = (r - 1//2)//M], stem:[r = 1,...,M], to the stem:[y_{(r)}] <<Cox-Harris2006>>. The numerical values stem:[p_r, r = 1,...,M], are the midpoints of stem:[ii(M)] contiguous probability intervals of width stem:[1//ii(M)] between zero and one;
. form stem:[tilde(G)_Y (eta)] as the (continuous) strictly increasing piecewise-linear function joining the stem:[ii(M)] points stem:[(y_{(r)},p_r)], stem:[r = 1,...,M]:
+
--
[[eqd1]]
[stem]
++++
tilde(G)_Y (eta) = {r - 1//2}/{ii(M)} + {eta - y(r)}/{ii(M)(y_{(r+1)}) - y_{(r)}}, " " y_{(r)} <= eta <= y_{(y+1)}, " " r = 1,..., ii(M) - 1
++++
--

NOTE: The form (<<scls_D-1>>) provides a convenient basis for sampling from stem:[tilde(G)_Y(eta)] for purposes of a further stage of uncertainty evaluation. See <<scls_C-2>> for sampling inversely from a distribution function. Some software libraries and packages provide facilities for piecewise-linear interpolation. Since stem:[tilde(G)_Y(eta)] is piecewise linear, so is its inverse, and such facilities can readily be applied.


[[scls_D-3]]
=== {blank}

<<figd1>> illustrates stem:[tilde(G)_Y(eta)] obtained using MCM based on stem:[ii(M) = 50] sampled values from a Gaussian PDF stem:[g_Y (eta)] with stem:[ii(Y)] having expectation 3 and standard deviation 1.

[[figd1]]
.An approximation stem:[tilde(G)_Y (eta)] to the distribution function stem:[G_Y (eta)] (<<scls_D-3>>). "Unit" denotes any unit
image::figured1.png[]


=== {blank}

Consider stem:[tilde(g)Y(eta) = tilde(G')_Y (eta)], with stem:[tilde(G)_Y (eta)] given in <<eqd1>>. The function stem:[tilde(g)_Y (eta)] is piecewise constant with breakpoints at stem:[eta = y_{(1)},..., y_{(M)}]. The expectation stem:[tilde(y)] and standard deviation stem:[u(tilde(y))] of stem:[ii(Y)], described by stem:[tilde(g)_Y(eta)], are taken, respectively, as an estimate of stem:[ii(Y)] and the standard uncertainty associated with that estimate. stem:[tilde(y)] and stem:[u(tilde(y))] are given by

[[eqd2]]
[stem]
++++
tilde(y) = 1/{ii(M)} sum_{r=1}^{ii(M)} '' y_{(r)}
++++

and

[[eqd3]]
[stem]
++++
u^2 (tilde(y)) = 1/{ii(M)} (sum_{r=1}^{ii(M)} '' (y_{(r)} - tilde(y)) - 1/6 sum_{r=1}^{ii(M)-1} (y_{(r+1)} - y_{(r)})^2),
++++

where the double prime on a summation symbol indicates that the first and the last terms in the sum are to be taken with weight one half.

NOTE: For a sufficiently large numerical value of stem:[ii(M)] (stem:[10^5], say, or greater), stem:[tilde(y)] and stem:[u(tilde(y))] obtained using <<eqd2>> and <<eqd3>> would generally be indistinguishable for practical purposes from those given by <<eq16>> and <<eq17>>, respectively.


=== {blank}

Let stem:[alpha] denote any value between zero and stem:[1 - p], where stem:[p] is the required coverage probability (e.g. 0.95). The endpoints of a stem:[100p " %"] coverage interval can be obtained from stem:[tilde(G)(eta)] by inverse linear interpolation. To determine the lower endpoint stem:[y_{"low"}] such that stem:[alpha = tile(G)_Y (y_{"low"})], identify the index stem:[r] for which the points stem:[(y_{(r)}, p_r)] and stem:[(y_{(r+1)}, p_{r+1})] satisfy

[stem%unnumbered]
++++
p_r <= alpha < p_{r+1}.
++++

Then, by inverse linear interpolation,

[stem%unnumbered]
++++
y_{"low"} = y_{(r)} + (y_{(r+1)} - y_{(r)}) {alpha - p_r}/{p_{r+1} - p_r}.
++++


Similarly, the upper endpoint stem:[y_{"high"}], determined such that stem:[p + alpha = tilde(G)_Y (y_{"high"})], is calculated from

[stem%unnumbered]
++++
y_{"high"} = y_{(s)} + (y_{(s+1)} - y_{(s)}) {p + alpha - p_s}/{p_{s+1} - p_s},
++++

where the index stem:[s] is such that the points stem:[(y_{(s)}, p_s)] and stem:[(y_{(s+1)}, p_{s+1})] satisfy

[stem%unnumbered]
++++
p_s <= p + alpha < p_{s+1}.
++++


=== {blank}

The choice stem:[alpha = 0.025] gives the coverage interval defined by the 0.025- and 0.975-quantiles. This choice provides the probabilistically symmetric 95 % coverage interval for stem:[ii(Y)].


=== {blank}

The shortest coverage interval can generally be obtained from stem:[tilde(G)_Y (eta)] by determining stem:[alpha] such that stem:[tilde(G)_Y^{-1} (p + alpha) - tilde(G)_Y^{-1} (alpha), = ii(H)(alpha)], say, is a minimum. A straightforward numerical approach to determining the minimum is to evaluate stem:[ii(H)(alpha)] for a large number of uniformly spaced choices stem:[{alpha_k}] of stem:[alpha] between zero and stem:[1 - p], and choose stem:[alpha_{cc(l)}] from the set stem:[{alpha_k}] that yields the minimum from the set stem:[{H(alpha_k)}].


=== {blank}

The computation of a coverage interval is facilitated if stem:[pM] is an integer. Then, the numerical value of stem:[alpha], such that stem:[ii(H)(alpha)] is a minimum, is equal to stem:[r^∗//M], where stem:[r^∗] is the index stem:[r] such that the interval length stem:[y_{(r+pM)} - y_{(r)}], over stem:[r = 1,..., (1 - p)M], is least.
